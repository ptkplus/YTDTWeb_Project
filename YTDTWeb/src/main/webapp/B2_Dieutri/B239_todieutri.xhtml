<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:s="http://jboss.com/products/seam/taglib"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:rich="http://richfaces.org/rich"
                xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
                xmlns:c="http://java.sun.com/jstl/core"
                template="../layout/mytemplate.xhtml">

    <ui:define name="body">
        <f:loadBundle var="msg" basename="com.iesvn.yte.UIResources" />
        <script type="text/javascript">
        var bSave = false;
        function checkMaxLength(field,maxlen) {
            if(field.value.length >= maxlen){
                field.value = field.value.substring(0,maxlen);                          }
        }


                function checkEmpty(id){
                                if ( document.getElementById(id).value == null || document.getElementById(id).value == "" ){
                                        if(document.getElementById(id).className.match(/focus/gi))
                                document.getElementById(id).className = document.getElementById(id).className.replace(/focus/gi,"");
                                        return false;
                                }
                                return true;
                        }
                        var enableEntToTab = true;
        function setEnableEntToTab(value) {
            enableEntToTab = value;
        }
        function checkMaxLength(field,maxlen) {
            if(field.value.length >= maxlen){
                field.value = field.value.substring(0,maxlen);                          }
        }
                        function enterToTab(){
                                          if(
                                                (document.getElementById(prefix_component + "__tieptucnhap") == null ||document.getElementById(prefix_component + "__tieptucnhap").alt != 1 ) &amp;&amp;
                                                (document.getElementById(prefix_component + "__ghinhan") == null ||document.getElementById(prefix_component + "__ghinhan").alt ) != 1  &amp;&amp;
                                                (document.getElementById(prefix_component + "__inan") == null ||document.getElementById(prefix_component + "__inan").alt ) != 1
                                   ) {
                                          if(window.event.keyCode == 13 &amp;&amp; enableEntToTab){
                                                 window.event.keyCode = 9;
                                           }
                                   }
                        }
		
				
		
                        function iesvn_Required() {
                                if (bSave) {
                                        this.ab = new Array(prefix_component + "__ngay", "<h:outputFormat value='#{msg.common_requireField}' > <f:param value='Thời gian'/> </h:outputFormat>", new Function ("varName",  "return this[varName];"));
                                }
                        }
                        function iesvn_ComparedDates() {
                                //this.aa = new Array([prefix_component + "__ngay",prefix_component + "__ngayhientai", "=="], "<h:outputFormat value='#{msg.common_compareDates}' > <f:param value='Thời gian'/> <f:param value='ngày hiện tại'/> </h:outputFormat>", new Function ("varName", "this.datePatternStrict='dd/MM/yyyy';  return this[varName];"));
			
                        }
                        function onSubmit() {
                                //changeCursorWait ();
                                var form = document.forms[0];
                                var valid = true;
                                if (bSave) {
                                        valid = iesvn_ValidateRequired(form) &amp;&amp; iesvn_ValidateComparedDates(form);  ;
                                }
                                bSave = false;
                            return valid;
                        }
        </script>
        <body>
            <h:form id="_form" name="_form" onsubmit="return onSubmit();">
                <h:inputHidden id="initTodieutri" value="#{initB239_Todieutri}"/>
                <div style="width:778px; position:absolute; z-index:99"><ui:include src="/layout/mymenu_YTDT_DieuTriNoiTru.xhtml" /></div>
                <table  style="margin-top:20px"  cellspacing="0" cellpadding="0" border="0" width="777">
                    <tr>
                        <td colspan="3" height="50px">
                            <table cellspacing="0" cellpadding="0" border="0" width="100%" >
                                <tr>
                                    <td height="50px" width="36%" style="padding-left: 18px; font-family: Arial; font-size: 18px; color: white; font-weight: bold;" >
                                        <h:graphicImage value="../images/white_light.gif" width="43" height="16" />
    						TỜ ĐIỀU TRỊ
                                    </td>
                                    <td valign="top">
                                        <table cellspacing="0" cellpadding="0" width="100%" >
                                            <tr>
                                                <td style="font-family: Arial; font-size: 12px; color: white; text-align: right; padding-right: 15px; padding-bottom: 2px; height: 25px; border-bottom: solid 1px #97989a;" valign="bottom" >
                                                    &#160;
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td width="13px" height="12px" class="mytdl">
                        </td>
                        <td style="background-color: #c9daea;" width="965px" height="12px" >
                        </td>
                        <td width="11px" height="12px" class="mytdr">
                        </td>
                    </tr>
                    <tr>
                        <td colspan="3" style="background-color: #c9daea; padding-top: 10px; padding-bottom: 15px" width="100%" >
                            <!-- Main Area -->
                            <table cellspacing="0" cellpadding="0" border="0" width="100%" >
                                <tr>
                                    <td width="100%" style="background-color: #c9daea; padding-top: 0px; padding-bottom: 0px" colspan="4" align="center">
                                        <a4j:outputPanel id="message_infor">

                                            <h:messages styleClass="mynull"/>

                                        </a4j:outputPanel>
                                    </td>
                                </tr>
                                <tr style="height: 25px;">
                                    <td align="right">
                                        <h:outputText value="Số bệnh án" styleClass="mytext" style="margin-right: 5px; margin-left: 5px;"/>

                                    </td>
                                    <td align="left" colspan="3">
                                        <h:inputText maxlength="12" tabindex="1" value="#{B239_Todieutri.hsbaMaso}" id="__sobenhan" name="_sobenhan" style=" width : 140px;" styleClass="myinput">
                                            <a4j:support oncomplete="highlightOnFocus();"
                                                         event="onblur" focus="__thoigian" action="#{B239_Todieutri.displayInfor}"
                                                         reRender="message_infor,__sobenhan,__khoa,__hoten,__gioitinh,__tuoi,__donViTuoi,__sobuong,__sogiuong,__chandoan,__thoigian,__ngay,__dienbienbenh,__ylenh,listKetqua,__ghinhan,__inan"/>
                                        </h:inputText>
                                        <h:outputText value="*" styleClass="mynull" />

                                        <h:outputText value="Khoa" styleClass="mytext" style="margin-left: 93px; margin-right: 5px"/>
                                        <h:inputText value="#{B239_Todieutri.tenKhoa}" id="__khoa" name="_khoa" style=" width : 240px;" styleClass="myreadonly" readonly="true"/>
                                    </td>
                                </tr>
                                <tr style="height: 25px;">
                                    <td align="right" >
                                        <h:outputText value="Họ tên" styleClass="mytext" style="margin-left: 5px; margin-right: 5px"/>

                                    </td>
                                    <td  align="left" colspan="3">
                                        <table cellspacing="0" cellpadding="0" border="0" width="100%">
                                            <tr>
                                                <td align="left" width="30%">
                                                    <h:inputText  readonly="true"  value="#{B239_Todieutri.hotenBN}" id="__hoten" name="_hoten" style="float: left; width : 183px;" styleClass="myreadonly"/>
                                                </td>
                                                <td align="left" width="26%">
                                                    <h:outputText value="Giới tính" styleClass="mytext" style="float: left; padding-top:3px; margin-left: 05px; margin-right: 0px;"/>
                                                    <h:selectOneRadio disabled="true" value="#{B239_Todieutri.gioitinh}" id="__gioitinh">
                                                        <f:selectItem id="__namItems" itemValue="1" itemLabel="Nam" styleClass="myreadonly" />
                                                        <f:selectItem id="__nuItems" itemValue="0" itemLabel="Nữ" styleClass="myreadonly" />
                                                    </h:selectOneRadio>
                                                </td>
                                                <td align="left">
                                                    <h:outputText value="Tuổi" styleClass="mytext" style=" margin-left: 4px; margin-right: 5px;"/>
                                                    <h:inputText readonly="true"  value="#{B239_Todieutri.tuoi}" id="__tuoi" name="_tuoi" style="margin-left: 0px; margin-right: 3px; width : 39px;" styleClass="myreadonly"/>

                                                    <h:outputText value="#{B239_Todieutri.donvituoi}" id="__donViTuoi" styleClass="mytext" style="margin-left: 5px;margin-right: 5px;"/>

                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                                <tr style="height: 25px;">
                                    <td align="right" style="width: 15%">
                                        <h:outputText value="Số buồng" styleClass="mytext" style="margin: 0 5px 0 5px"/>
                                    </td>
                                    <td  align="left" colspan="3">
                                        <h:inputText value="#{B239_Todieutri.sobuong}" id="__sobuong" name="_sobuong"  style=" width : 40px;" styleClass="myreadonly" readonly="true"/>
                                        <h:outputText value="Số giường" styleClass="mytext" style="margin: 0 5px 0 5px"/>
                                        <h:inputText value="#{B239_Todieutri.sogiuong}" id="__sogiuong" name="_sogiuong"  style=" width : 40px;" styleClass="myreadonly" readonly="true"/>
                                        <h:outputText value="Chẩn đoán" styleClass="mytext" style="margin: 0 5px 0 8px"/>
                                        <h:inputText value="#{B239_Todieutri.chandoan}" id="__chandoan" name="_chandoan" style=" width :300px;" styleClass="myinput" readonly="true"/>

                                    </td>
                                </tr>

                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="3" style="background-color: white; padding-top: 15px; padding-bottom: 2px;" width="100%">

                            <table cellspacing="0" cellpadding="0" border="0" width="100%" >
                                <tr style="height: 25px;">
                                    <td align="left" style="padding-left: 32px">
                                        <table cellspacing="0" cellpadding="0" border="0" width="95%" >
                                            <tr style=" height : 20px;" >
                                                <td align="right" style="width: 15%">
                                                    <h:outputText value="Thời gian" styleClass="mytext" style="margin: 0 5px 0 5px"/>
                                                </td>
                                                <td  align="left">
                                                    <h:inputText   maxlength="5"  onkeypress="iesvn_InputInKeys('1234567890:');" value="#{B239_Todieutri.gio}" tabindex="2" id="__thoigian" name="_thoigian" style="width: 33px;" styleClass="myinput"
                                                                   onkeyup="checkHour(this);" onblur='if(this.className.match(/focus/gi))    this.className = this.className.replace(/focus/gi,""); checkHourBlur(this)'/>

                                                    <h:outputText value="GG:pp" styleClass="mytext" style="margin-left: 3px; margin-right: 2px"/>
                                                    <h:inputText value="#{B239_Todieutri.ngay}" onkeypress="return being_wellformed_Date(this, event)"
                                                                tabindex="3" type="text" id="__ngay" name="_ngay" maxlength="10" style="width:70px" class="myinput">
		                                                        <a4j:support event="onblur"
		                                                            action="#{B239_Todieutri.get_thuoc_info()}"
		                                                            oncomplete='if(this.className.match(/focus/gi)) this.className = this.className.replace(/focus/gi,"");return is_wellformed_Date(this);'
		                                                            reRender="__ylenh">
		                                                        </a4j:support>
                                                    </h:inputText>
                                                    <a hideFocus="true" href="javascript:void(0)" onclick="if(self.gfPop)gfPop.fPopCalendar(document.getElementById(prefix_component + '__ngay'));return false;" ><h:graphicImage style="margin:0 0 -4px 0" value="/resources/calendar/cal.gif" border="0" name="popcal"/></a>
                                                    <h:outputText value="*" styleClass="mynull"
                                                                  style="margin-right: 5px; margin-left: 2px;" />

                                                </td>
                                            </tr>
                                            <tr style=" height : 20px;" >
                                                <td align="right" style="width: 15%" valign="top">
                                                    <h:outputText value="Diễn biến bệnh" styleClass="mytext" style="margin: 0 5px 0 5px"/>
                                                </td>
                                                <td  align="left">
                                                    <h:inputTextarea   value="#{B239_Todieutri.tdt.todieutriTheodoidienbien}" tabindex="4" id="__dienbienbenh" name="_dienbienbenh" rows="4" cols="65"  styleClass="myinput" style="width:550px;height: 50px" onkeydown="setEnableEntToTab(false)" onblur="setEnableEntToTab(true)" onkeyup="checkMaxLength(this,1020)" />
                                                </td>
                                            </tr>
                                            <tr style=" height : 20px;" >
                                                <td align="right" style="width: 15%" valign="top">
                                                    <h:outputText value="Y lệnh" styleClass="mytext" style="margin: 0 5px 0 5px"/>
                                                </td>
                                                <td  align="left">
                                                    <h:inputTextarea  value="#{B239_Todieutri.tdt.todieutriThuchienchamsoc}" tabindex="5" id="__ylenh" name="_ylenh" rows="4" cols="65"  styleClass="myinput" style="width:550px;height: 50px" onkeydown="setEnableEntToTab(false)" onblur="setEnableEntToTab(true)" onkeyup="checkMaxLength(this,2045)" />
                                                </td>
                                            </tr>


                                        </table>
                                    </td>
                                </tr>


                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="3" style="background-color: white; padding-top: 0px; padding-bottom: 15px;" width="100%">
                            <!-- Detail Area -->
                            <table cellspacing="0" cellpadding="0" border="0" width="100%" >
                                <tr style="height: 25px;">

                                    <td align="left" style="padding-left: 250px; padding-top: 5px;padding-bottom: 15px;" colspan="2">
                                        <div class="mybton_b_l" style="width: 95px; float: left;">
                                            <div style="background-position: 80px 0px; float: left ; padding-right: 5px" class="mybton_b_r">
                                                <a4j:commandButton disabled="#{!(B239_Todieutri.hsbaMaso.trim().length() > 0)}" tabindex="30" id="__ghinhan" name="_ghinhan" type="submit" value="Ghi nhận" style="width: 80px;" styleClass="mybton_b" action="#{B239_Todieutri.addChitiet}" reRender="listKetqua,__thoigian,__ngay,__dienbienbenh,__ylenh,__inan"
                                                                   oncomplete="document.getElementById(prefix_component + '__thoigian').focus();"
                                                                   onclick="bSave=true;"/>
                                            </div>
                                        </div>
                                        <div class="mybton_b_l" style="width: 115px; float: left;">
                                            <div style="background-position: 100px 0px; float: left ; padding-right: 5px" class="mybton_b_r">
                                                <a4j:commandButton tabindex="31" id="__tieptucnhap" name="_tieptucnhap" type="submit" value="Nhập mới" style="width: 100px;" styleClass="mybton_b" action="#{B239_Todieutri.resetValue}" reRender="message_infor,__sobenhan,__khoa,__hoten,__gioitinh,__tuoi,__donViTuoi,__sobuong,__sogiuong,__chandoan,__thoigian,__ngay,__dienbienbenh,__ylenh,listKetqua,__ghinhan,__inan"
                                                                   oncomplete="document.getElementById(prefix_component + '__sobenhan').focus();"/>
                                            </div>
                                        </div>
                                        <div class="mybton_b_l" style="width: 75px; float: left;">
                                            <div style="background-position: 60px 0px; float: left ; padding-right: 5px" class="mybton_b_r">
                                                <h:commandButton tabindex="32" disabled="#{B239_Todieutri.listTdt.size() &lt; 1}" id="__inan" name="_inan" type="submit" value="In ấn" action="#{B239_Todieutri.thuchienAction}" style="width: 60px;" styleClass="mybton_b"/>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr style="height: 25px;">
                                    <td align="left" style="padding-left: 32px">
                                        <table cellspacing="0" cellpadding="0" border="0" width="95%" style="border: solid 1px #7a9dba;">
                                            <tr style=" height : 20px;" class="mycol">


                                                <td align="center" style="width: 20%; border-right: solid 1px; border-color:#ffffff;">
                                                    <h:outputText value="Ngày giờ"/>
                                                </td>
                                                <td align="center" style="border-right: solid 1px; border-color:#ffffff;">
                                                    <h:outputText value="Diễn biến bệnh"/>
                                                </td>


                                                <td align="center" style="width:35%;">
                                                    <h:outputText value="Y lệnh" />
                                                </td>

                                            </tr>

                                            <tr>
                                                <td colspan="8" >
                                                    <div style="overflow-y: scroll; overflow-x: hidden; height:100px; border: solid 0px #54779f; width: 100%">

                                                        <h:panelGroup id="listKetqua">

                                                            <rich:dataTable id="dataChitiet" value="#{B239_Todieutri.listTdt}" var="currentRow">


                                                                <rich:column style="width:20%">
                                                                    <a4j:commandLink id="giophut" value="#{B239_Todieutri.showGioNgay(currentRow.todieutriNgaygio)}" action="#{B239_Todieutri.editChitiet(currentRow)}" reRender="__thoigian,__ngay,__dienbienbenh,__ylenh"
                                                                                     oncomplete="document.getElementById(prefix_component + '__thoigian').focus();"/>
                                                                </rich:column>
                                                                <rich:column>
                                                                    <h:outputText id="theodoidienbien" value="#{currentRow.todieutriTheodoidienbien}" />
                                                                </rich:column>

                                                                <rich:column style="width:29%">
                                                                    <h:outputText id="ylenh" value="#{currentRow.todieutriThuchienchamsoc} (#{currentRow.todieutriTenbs})" />
                                                                </rich:column>
                                                                <rich:column id="column_deletect"  style="width:6%" >
                                                                    <a4j:commandLink id="delete" action="#{B239_Todieutri.deleteChitiet(currentRow)}" reRender="__thoigian,__ngay,__dienbienbenh,__ylenh,listKetqua,__inan"
                                                                                     oncomplete="document.getElementById(prefix_component + '__thoigian').focus();"><h:graphicImage value="/images/icon_delete2.gif" style="width: 19px; height: 16px; cursor: hand;"/></a4j:commandLink>
                                                                </rich:column>

                                                            </rich:dataTable>

                                                        </h:panelGroup>

                                                    </div>
                                                </td>
                                            </tr>

                                        </table>
                                    </td>
                                </tr>


                            </table>
                        </td>
                    </tr>
                </table>
                <h:inputHidden id="__ngayhientai" value="#{B239_Todieutri.ngayhientai}"/>
            </h:form>
        </body>
        <script type="text/javascript" src="#{facesContext.externalContext.requestContextPath}/resources/gears/dieutri/hsba/B239_Todieutri_gears.js"></script>
        <iframe width="174" height="189" name="gToday:normal:agenda.js" id="gToday:normal:agenda.js" src="#{facesContext.externalContext.requestContextPath}/resources/calendar/ipopeng.htm" scrolling="no" frameborder="0" style="visibility:visible; z-index:999; position:absolute; top:-500px; left:-500px;"/>
    </ui:define>
</ui:composition>
