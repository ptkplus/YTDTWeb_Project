<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a4j="http://richfaces.org/a4j"
	template="/layout/mytemplate.xhtml">


	<ui:define name="body">
		<f:loadBundle basename="com.iesvn.yte.UIResources" var="msg" />
		<script type="text/javascript">	
		
		function enterToTab(){
          	if(document.getElementById(prefix_component +"__timkiemPhieuNhap") == null || document.getElementById(prefix_component +"__timkiemPhieuNhap").alt != 1)  
          	{
                 if(window.event.keyCode == 13){
                        window.event.keyCode = 9;
                  }
         	}
		} 	
		</script>
	<body onkeydown="enterToTab();">
		<div id="sync_error_display" style="position:absolute; top:20px; left:578px; width:200px; height:50px"/>
		<h:form id="_form" name="_form">
			<div style="width: 778px; position: absolute; z-index:99"><ui:include
				src="/layout/mymenu_YTDT_DuocPham_KhoChinh.xhtml" /></div>
			<h:inputHidden id="__ngayhientai" name="_ngayhientai" value="#{Timkiemphieunhap.ngayHt}" />			
			<h:inputHidden id="count" value="#{Timkiemphieunhap.count}" />
			<table style="margin-top:14px" cellspacing="0" cellpadding="0" border="0" width="777">
				<tr>
					<td colspan="3" height="50px">
					<table cellspacing="0" cellpadding="0" border="0" width="100%">
						<tr>
							<td height="50px" width="38%"
								style="padding-left: 18px; font-family: Arial; font-size: 18px; color: white; font-weight: bold;">
								<h:graphicImage value="/images/white_light.gif" width="43" height="16" />TÌM KIẾM PHIẾU NHẬP
							</td>
							<td valign="top">
								<table cellspacing="0" cellpadding="0" width="100%">
									<tr>
										<td style="font-family: Arial; font-size: 12px; color: white; text-align: right; padding-right: 15px; padding-bottom: 2px; height: 25px; border-bottom: solid 1px #97989a;"
											valign="bottom"> &#160; </td>
									</tr>
								</table>							
							</td>
						</tr>
					</table>
					</td>
				</tr>
				<tr>					
					<td style="background-color: #c9daea;" width="965px" height="12px">
					</td>
					<td style="background-color: #c9daea;" width="11px" height="12px" class="mytdr"></td>
				</tr>
				<tr>
		    	<td colspan="3" style="background-color: #c9daea;" width="100%" align="center" >
		    		<a4j:outputPanel id="message_infor">
		    			<h:messages styleClass="mynull"/>
		    		</a4j:outputPanel>
		    	</td>
		    	</tr>
				<tr>
					<td align="center" colspan="3"
						style="background-color: #c9daea; padding-top: 0px; padding-bottom: 10px"
						width="100%"><!-- Main Area -->
						<table cellspacing="0" cellpadding="0" width="98%" border="0">
						<tr>
							<td align="right" width="13%"><h:outputText value="Mã phiếu"
								styleClass="mytext" /> &#160;
							</td>
							<td align="left" width="46%">
								<h:inputText value="#{Timkiemphieunhap.maPhieu}" id="TIMKIEMPHIEU_MATK"
									name="timkiem" style=" width : 110px;" maxlength="15"
									tabindex="1" styleClass="myinput">								
								</h:inputText>							
								<h:outputText value="Ngày nhập" styleClass="mytext"
									style="margin-left: 32px; margin-right: 5px" /> 
								<h:inputText
									id="__ngaynhaptk" name="timkiem" value="#{Timkiemphieunhap.ngayHt}" maxlength="10" tabindex="2"
									style=" width : 70px;" styleClass="myinput" />								
								<a hideFocus="true"
									onclick="if(self.gfPop)gfPop.fPopCalendar(document.getElementById(prefix_component + '__ngaynhaptk'));return false;"
									href="javascript:void(0)"> 
									<h:graphicImage style="margin:0 0 -4px 0" value="/resources/calendar/cal.gif"
										border="0" name="popcal" />
								</a>	
							</td>
							<td align="right" width="13%"><h:outputText value="Loại phiếu" styleClass="mytext" /> &#160;</td>
							<td align="left">
								<h:inputHidden id="DTDMLOAI_MA_pk" value="#{Timkiemphieunhap.loaiThuocMaSo}" />
								<h:inputText id="DTDMLOAI_MA" value="#{Timkiemphieunhap.loaiThuocMa}"
										name="DTDMLOAI_MA" style=" width : 40px;" maxlength="4" onblur="myOnblurTextbox(this.id, 'DM_LOAI_THUOC')"
										tabindex="3" styleClass="myinput"/> 
								<span id="LOAI_span" /> <input id="DM_LOAI_THUOC" name="DM_LOAI_THUOC" tabindex="4"	style="width: 110px;" />
							</td>
						</tr>
						<tr>
							<td align="right"><h:outputText value="Chứng từ" styleClass="mytext" /> &#160;</td>
							<td align="left">
								<h:inputText id="CHUNGTU" value="#{Timkiemphieunhap.soChungTu}"
										name="_chungtu" style=" width : 297px;" maxlength="50"
										tabindex="5" styleClass="myinput"/> 
							</td>
							<td align="right" width="13%"><h:outputText value="Số HĐ" styleClass="mytext" /> &#160;</td>
							<td align="left">
								<h:inputText id="SOHOADON" value="#{Timkiemphieunhap.soHD}"
										name="_hoadon" style=" width : 158px;" maxlength="50"
										tabindex="6" styleClass="myinput"/> 
							</td>	
						</tr>
						</table>										
					</td>
				</tr>
				<tr style="height: 40px;">
					<td align="center" colspan="3" style="background-color: white; padding-left:300px;" >
						<div  id="divtimkiem"  style=" float: left;">    							
    						<a4j:commandButton id="__timkiemPhieuNhap" value="Tìm kiếm" tabindex="7" 
    								styleClass="mybton_b" action="#{Timkiemphieunhap.timkiem()}"     								
    								style="width: 60px; margin-right: 3px;" 
    								reRender="__myTableTimKiem,__myTable,PHIEUNHAPKHO_MA,_ngaynhap,TENLOAITHUOC,DTDMNHANVIEN_CN,PHIEUNHAPKHO_CHUNGTU,DMKINHPHI_MASO,PHIEUNHAPKHO_SOHOADON,DTDMNHANVIEN_TIEPLIEU,DTDMNOIBAN_MA,PHIEUNHAPKHO_NGAYHOADON,DTDMNGUON_TEN,DMKHO_MASO,PHIEUNHAPKHO_MUCTHUE,PHIEUNHAPKHO_THUE,PHIEUNHAPKHO_THANHTIEN,__thanhtienthue"/>						
    					
    						<a4j:commandButton id="__lammoi"     								
    								value="Làm mới" styleClass="mybton_b" 
    								action="#{Timkiemphieunhap.reset()}"  style="width: 60px; margin-right: 3px;" 
    								reRender="__myTableTimKiem,__myTable,PHIEUNHAPKHO_MA,_ngaynhap,TENLOAITHUOC,DTDMNHANVIEN_CN,PHIEUNHAPKHO_CHUNGTU,DMKINHPHI_MASO,PHIEUNHAPKHO_SOHOADON,DTDMNHANVIEN_TIEPLIEU,DTDMNOIBAN_MA,PHIEUNHAPKHO_NGAYHOADON,DTDMNGUON_TEN,DMKHO_MASO,PHIEUNHAPKHO_MUCTHUE,PHIEUNHAPKHO_THUE,PHIEUNHAPKHO_THANHTIEN,__thanhtienthue"/>
    					</div>
    				</td>
				</tr>
				<tr>
					<td align="center" colspan="3"
						style="background-color: white; padding-top: 15px; padding-bottom: 5px;"
						width="100%">
						<table border="0" cellspacing="0" cellpadding="0" style="width:98%;" align="center" >
							<tr>
								<td colspan="8" style="border:solid 1px #7e9dba;" >	
										<rich:dataTable headerClass="mycol" id="__myTableTimKiem" var="row" value="#{listResultPhieuNhap}"
												cellpadding="0" cellspacing="1" rowClasses="myrow1,myrow2" reRender="__ds"
												border="0" style="width: 100%;" rows="10" >
										<rich:column style="width:11%;" >
											<f:facet name="header"><h:outputText value="Mã phiếu"/></f:facet>
											<h:outputText value="" />		
												<a4j:commandLink value="#{row.phieunhapkhoMa}" 
													action="#{Timkiemphieunhap.selectPhieuNhap(listResultPhieuNhap.rowIndex)}" style="width:9%;"
													reRender="__myTable,PHIEUNHAPKHO_MA,_ngaynhap,TENLOAITHUOC,DTDMNHANVIEN_CN,PHIEUNHAPKHO_CHUNGTU,DMKINHPHI_MASO,PHIEUNHAPKHO_SOHOADON,DTDMNHANVIEN_TIEPLIEU,DTDMNOIBAN_MA,PHIEUNHAPKHO_NGAYHOADON,DTDMNGUON_TEN,DMKHO_MASO,PHIEUNHAPKHO_MUCTHUE,PHIEUNHAPKHO_THUE,PHIEUNHAPKHO_THANHTIEN,__thanhtienthue"></a4j:commandLink>					
										</rich:column>
										<rich:column style="width:11%;" align="left" >
											<f:facet name="header"><h:outputText value="Số chứng từ"/></f:facet>
											<h:outputText value="#{row.phieunhapkhoChungtu}" />					
										</rich:column>
										<rich:column style="width:13%;" align="left" >
											<f:facet name="header"><h:outputText value="Số hóa đơn"/></f:facet>
											<h:outputText value="#{row.phieunhapkhoSohoadon}" />					
										</rich:column>
										<rich:column style="width:20%;" align="left" >
											<f:facet name="header"><h:outputText value="Loại thuốc"/></f:facet>
											<h:outputText value="#{row.getDmloaithuocMaso(true).dmloaithuocTen}" />					
										</rich:column>
										<rich:column style="width: 20%;" >
											<f:facet name="header"><h:outputText value="Người nhập"/></f:facet>
											<h:outputText value="#{row.getDtdmnhanvienCn(true).dtdmnhanvienTen}"  />							
										</rich:column>
										<rich:column style="width: 10%;" >
											<f:facet name="header"><h:outputText value="Ngày nhập"/></f:facet>
											<h:outputText value="#{row.phieunhapkhoNgaygiocn}" >
												<f:converter converterId="com.iesvn.yte.converter.DateConverter" />	
											</h:outputText>						
										</rich:column>
										<rich:column style="width:25%;" align="right" >
											<f:facet name="header"><h:outputText value="Thành tiền"/></f:facet>
											<h:outputText value="#{row.phieunhapkhoThanhtien}">
												<f:converter converterId="com.iesvn.yte.converter.DoubleConverter2FractionDigits" />
											</h:outputText>
										</rich:column>
										<f:facet name="footer">
				               				<rich:datascroller id="__ds" renderIfSinglePage="false" ></rich:datascroller>
				           				</f:facet>
										</rich:dataTable>
								</td>
							</tr>
						</table>
					</td>
				</tr>
				<tr>
						<td width="100%" height="50px" style="BACKGROUND-COLOR: #99c1ee; padding-left: 18px; font-family: Arial; font-size: 16px; color: black; font-weight: bold;">
							Thông tin chi tiết phiếu nhập
						</td>
				</tr>
				<tr>
					<td align="center" colspan="3"
						style="background-color: white; padding-top: 15px; padding-bottom: 5px;"
						width="100%"><!-- Detail Area -->
						<table cellspacing="0" cellpadding="0" border="0" width="100%">
							<tr>
								<table cellspacing="0" cellpadding="0" width="98%" border="0">						
									<tr>
										<td align="right" width="13%"><h:outputText value="Mã phiếu" styleClass="mytext" /> &#160;</td>
										<td align="left" width="30%">
											<h:inputText readonly="true" value="#{Timkiemphieunhap.pnk.phieunhapkhoMa}" id="PHIEUNHAPKHO_MA" name="phieunhap" style=" width : 110px;" maxlength="15"
												styleClass="myinput">										
											</h:inputText>
										</td>
										<td align="right" width="20%"><h:outputText value="Ngày nhập" styleClass="mytext" /> &#160;</td>
										<td align="left" width="37%">
											<h:inputText readonly="true" id="_ngaynhap" name="phieunhap" value="#{Timkiemphieunhap.ngaygiocn}" maxlength="10"
												style=" width : 70px;" styleClass="myinput" />											
										</td>
									</tr>
									<tr>
										<td align="right" width="13%"><h:outputText value="Loại phiếu" styleClass="mytext" /> &#160;</td>
										<td align="left" width="30%">
											<h:inputText readonly="true" id="TENLOAITHUOC" value="#{Timkiemphieunhap.pnk.getDmloaithuocMaso(true).dmloaithuocTen}" name="DTDMLOAI_MA" style=" width : 170px;" maxlength="4"
												styleClass="myinput" />
										</td>
										<td align="right" width="20%"><h:outputText value="Thủ kho" styleClass="mytext" /> &#160;</td>
										<td align="left" width="30%">										 									
											<h:inputText readonly="true" id="DTDMNHANVIEN_CN" name="phieunhap" style=" width : 170px;" maxlength="8" value="#{Timkiemphieunhap.pnk.getDtdmnhanvienCn(true).dtdmnhanvienTen}"
												styleClass="myinput" />
										</td>											
									</tr>
									<tr>
										<td align="right"><h:outputText value="Chứng từ" styleClass="mytext" /> &#160;</td>
										<td align="left">
											<h:inputText readonly="true" id="PHIEUNHAPKHO_CHUNGTU" value="#{Timkiemphieunhap.pnk.phieunhapkhoChungtu}"
											name="_chungtu" style=" width : 170px;" maxlength="50"
											 styleClass="myinput"/>
										</td>
										<td align="right"><h:outputText value="Nguồn KP" styleClass="mytext" /> &#160;</td>
										<td align="left">																				
											<h:inputText readonly="true" value="#{Timkiemphieunhap.pnk.getDmnguonkinhphiMaso(true).dmnguonkinhphiTen}" id="DMKINHPHI_MASO" name="_manguonkp" style="width : 170px;" maxlength="2" styleClass="myinput" /> 										
										 </td>		
									</tr>
									<tr>
										<td align="right"><h:outputText value="Số HĐ" styleClass="mytext" nowrap="true" /> &#160;</td>
										<td align="left">
											<h:inputText readonly="true" id="PHIEUNHAPKHO_SOHOADON" value="#{Timkiemphieunhap.pnk.phieunhapkhoSohoadon}"
												name="_sohd" style=" width : 170px;" maxlength="12" styleClass="myinput"/>
										</td>
										<td align="right"><h:outputText value="NV nhập liệu" styleClass="mytext" nowrap="true" /> &#160;</td>
										<td align="left">																		
											<h:inputText value="#{Timkiemphieunhap.pnk.getDtdmnhanvienTieplieu(true).dtdmnhanvienTen}"
											 id="DTDMNHANVIEN_TIEPLIEU" name="_maNVtieplieu" style=" width : 170px;" maxlength="8"										
												tabindex="15" styleClass="myinput"/> 
										</td>		
									</tr>
									<tr>
										<td align="right"><h:outputText value="Nơi bán" styleClass="mytext" /> &#160;</td>
										<td align="left">
											<h:inputText readonly="true" id="DTDMNOIBAN_MA" value="#{Timkiemphieunhap.pnk.getDtdmnoibanMa(true).dmnhacungcapTen}"
												name="_manoiban" style=" width : 250px"
												maxlength="10" styleClass="myinput" /> 
										</td>
										<td align="right"><h:outputText value="Ngày lập" styleClass="mytext" /> &#160;</td>
										<td align="left">
											<h:inputText readonly="true" id="PHIEUNHAPKHO_NGAYHOADON" value="#{Timkiemphieunhap.ngayHoaDon}"
												onblur='if(this.className.match(/focus/gi))    this.className = this.className.replace(/focus/gi,""); return testNgayHoaDon(this);'
												name="_ngaylap" style=" width : 70px"
												maxlength="10" styleClass="myinput" /> 
										</td>		
									</tr>
									<tr>
										<td align="right" ><h:outputText value="Chương trình" styleClass="mytext" nowrap="true" />
										&#160;</td>
										<td align="left">									
											<h:inputText readonly="true" id="DTDMNGUON_TEN" value="#{Timkiemphieunhap.pnk.getDmnctMaso(true).dmnctTen}"
											name="_machuongtrinh" style=" width : 250px;" maxlength="2"
											styleClass="myinput" />									
										</td>
										<td align="right" style="padding-left: 0px"><h:outputText value="Kho nhập" styleClass="mytext" nowrap="true" />	&#160;</td>
										<td align="left">									
											<h:inputText readonly="true" id="DMKHO_MASO" value="#{Timkiemphieunhap.pnk.getDtdmkhoMaso(true).dtdmkhoTen}"
											name="_makhonhap" style=" width : 170px;" maxlength="5"
											styleClass="myinput" />									
										</td>
									</tr>
									<tr>
										<td align="right"><h:outputText value="Thuế GTGT%" styleClass="mytext" nowrap="true" />	&#160;</td>
										<td align="left">									
										<h:inputText readonly="true" id="PHIEUNHAPKHO_MUCTHUE" value="#{Timkiemphieunhap.pnk.phieunhapkhoMucthue}"
											name="_thueGTGT_pt" style="width : 70px; text-align: right;" maxlength="5"
											styleClass="myinput" />									
										</td>
										<td align="right" style="padding-left: 0px"><h:outputText
											value="Thuế GTGT" styleClass="mytext" nowrap="true" />
										&#160;</td>
										<td align="left">									
											<h:inputText readonly="true" id="PHIEUNHAPKHO_THUE" value="#{Timkiemphieunhap.pnk.phieunhapkhoThue}"
											name="_thueGTGT" style=" width : 99px; text-align: right;" maxlength="5"
											styleClass="myinput" >
											<f:converter converterId="com.iesvn.yte.converter.LongDoubleConverter" />
											</h:inputText>									
										</td>											
									</tr>
									<tr>
										<td align="right" style="padding-left: 0px"><h:outputText
											value="Thành tiền" styleClass="mytext"
											style="margin-right: 5px; margin-left:5px;" /></td>
										<td align="left">
											<h:inputText readonly="true" value="#{Timkiemphieunhap.pnk.phieunhapkhoThanhtien}" id="PHIEUNHAPKHO_THANHTIEN" name="_thanhtien"
												style=" width : 170px; text-align: right;" styleClass="myinput">
												<f:converter converterId="com.iesvn.yte.converter.LongDoubleConverter" />
											</h:inputText>
										</td>
										<td align="right"><h:outputText value="Thành tiền + Thuế" styleClass="mytext" />&#160;</td>
										<td align="left">
											<h:inputText readonly="true" value="#{Timkiemphieunhap.thanhTienThue}" id="__thanhtienthue" name="_thanhtienthue"
												style=" width : 170px;text-align: right;" styleClass="myinput">
												<f:converter converterId="com.iesvn.yte.converter.LongDoubleConverter" />
											</h:inputText>
										</td>
									</tr>
								</table>
						</tr>						
						<tr>
							<td colspan="2" style="background-color: white; padding-top: 15px; padding-bottom: 5px;" >
								<table border="0" cellspacing="0" cellpadding="0" style="width:98%;" align="center" >									
									<tr>
										<td colspan="8" style="border:solid 1px #7e9dba;" >
											<rich:dataTable headerClass="mycol" id="__myTable" var="row" value="#{Timkiemphieunhap.listCtNhapKho}"
												cellpadding="0" cellspacing="1" rowClasses="myrow1,myrow2"
												border="0" style="width: 100%;" rows="10" reRender="__dsThuoc">
												<rich:column style="width:9%;" >
													<f:facet name="header"><h:outputText value="Mã số"/></f:facet>
													<h:outputText value="#{row.getDmthuocMaso(true).dmthuocMa}" />							
												</rich:column>
						
												<rich:column style="width:27%;" align="left" >
													<f:facet name="header"><h:outputText value="Tên thuốc"/></f:facet>
													<h:outputText value="#{row.getDmthuocMaso(true).dmthuocTen}" />						
												</rich:column>
						
												<rich:column style="width: 10%;" >
													<f:facet name="header"><h:outputText value="Đơn vị"/></f:facet>
													<h:outputText value="#{row.getDmthuocMaso(true).getDmdonvitinhMaso(true).dmdonvitinhTen}"  />							
												</rich:column>
						
												<rich:column style="width:13%;" align="right" >
													<f:facet name="header"><h:outputText value="Số lượng"/></f:facet>
													<h:outputText value="#{row.ctnhapkhoSoluong}">
														<f:converter converterId="com.iesvn.yte.converter.DoubleConverter2FractionDigits" />
													</h:outputText>
												</rich:column>
																		
												<rich:column style="width: 10%;" align="right" >
													<f:facet name="header"><h:outputText value="Đơn giá"/></f:facet>
													<h:outputText value="#{row.ctnhapkhoDongiaban}">
														<f:converter converterId="com.iesvn.yte.converter.DoubleConverter2FractionDigits" />
													</h:outputText>							
												</rich:column>
												<rich:column style="width: 10%;" align="right" >
													<f:facet name="header"><h:outputText value="Đơn giá VAT"/></f:facet>
													<h:outputText value="#{row.ctnhapkhoDongia}">
														<f:converter converterId="com.iesvn.yte.converter.DoubleConverter2FractionDigits" />
													</h:outputText>							
												</rich:column>
												<rich:column style="width: 15%;" align="right" >
													<f:facet name="header"><h:outputText value="Thành tiền"/></f:facet>
													<h:outputText id="colTT" value="#{row.ctnhapkhoSoluong * row.ctnhapkhoDongia}">
														<f:converter converterId="com.iesvn.yte.converter.DoubleConverter2FractionDigits" />
													</h:outputText>							
												</rich:column>
												<f:facet name="footer">
						               				<rich:datascroller id="__dsThuoc" renderIfSinglePage="false" ></rich:datascroller>
						           				</f:facet>
											</rich:dataTable>
										</td>
									</tr>
								</table> 									
							</td>
						</tr>
						
					</table>					
					
					
					</td>
				</tr>	
			</table>
			<script type="text/javascript"
			src="#{facesContext.externalContext.requestContextPath}/resources/gears/dieutri/duocpham/TimKiemPhieuNhap_gears.js"></script>
		<iframe width="174" height="189" name="gToday:normal:agenda.js"
			id="gToday:normal:agenda.js"
			src="#{facesContext.externalContext.requestContextPath}/resources/calendar/ipopeng.htm"
			scrolling="no" frameborder="0"
			style="visibility: visible; z-index: 999; position: absolute; top: -500px; left: -500px;" />
		</h:form>
		
		</body>
		
	</ui:define>
</ui:composition>


