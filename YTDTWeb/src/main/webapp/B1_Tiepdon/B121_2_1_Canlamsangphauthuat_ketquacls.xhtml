<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:s="http://jboss.com/products/seam/taglib"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
                xmlns:rich="http://richfaces.org/rich"
                xmlns:c="http://java.sun.com/jstl/core"
                template="/layout/mytemplate.xhtml">
    <ui:define name="body">

        <f:loadBundle basename="com.iesvn.yte.UIResources" var="msg" />
        <f:loadBundle basename="com.iesvn.yte.ApplicationResources" var="app" />
        <script type="text/javascript" src="swfobject.js"/>
        <script type="text/javascript">
        //var test = document.getElementById(prefix_component + "__hoten");
  
        function trove(){

              var doc = opener.document;
              //doc.getElementById(prefix_component + "__mabenhnhan").value = __mabenhnhan;
              //doc.getElementById(prefix_component + "__matiepdon").value = __matiepdon;
              //alert(document.getElementById(prefix_component + "__dathuchien").checked);


              doc.getElementById(prefix_component + "giatrithuchien_hid").value =
                 document.getElementById(prefix_component + "thatSuThucHien_hid").value;

              //alert(doc.getElementById(prefix_component + "giatrithuchien_hid").value);

              //	alert(doc.getElementById(prefix_component + "refresh"));
              doc.getElementById(prefix_component + "refresh").onclick();
              return true;
        }
        var enableEntToTab = true;
        function setEnableEntToTab(value) {
            enableEntToTab = value;
        }
        function checkMaxLength(field,maxlen) {
            if(field.value.length >= maxlen){
                field.value = field.value.substring(0,maxlen);                          }
        }
      function enterToTab(){

                        if(	(document.getElementById(prefix_component + "__quaylai") == null ||document.getElementById(prefix_component + "__quaylai").alt != 1 ) &amp;&amp;
                              (document.getElementById(prefix_component + "__ghinhan") == null ||document.getElementById(prefix_component + "__ghinhan").alt  != 1   )
                 ) {

                        if(window.event.keyCode == 13 &amp;&amp; enableEntToTab){
                               window.event.keyCode = 9;
                         }
                 }
      }
                var ghiNhan = false;
            function iesvn_Required() {
                              if (ghiNhan == true){
                                      this.aa = new Array(prefix_component + "DT_DM_BAN_KHAM_MA", "<h:outputFormat value='#{msg.common_requireField}' > <f:param value='Bàn khám'/> </h:outputFormat>", new Function ("varName",  "return this[varName];"));
                                      this.ab = new Array(prefix_component + "__matiepdon", "<h:outputFormat value='#{msg.common_requireField}' > <f:param value='Mã tiếp đón'/> </h:outputFormat>", new Function ("varName",  "return this[varName];"));
                              }
                }
 	  
                      function onSubmit_ghinhan(){
                              changeCursorWait ();
                              ghiNhan = true;
                              var form = document.forms[0];
                              var valid = iesvn_ValidateRequired(form)  ;
                      ghiNhan = false;
                      if (valid == false){
                              changeCursorDefault ();
                      }
                      return valid;
	    	
                      }
                function onSubmit() {
                              changeCursorWait ();
                              var form = document.forms[0];
                              var valid = true;
				    	    	
                      valid = iesvn_ValidateRequired(form)  ;
                      if (valid == true){
                              valid =  iesvn_ValidateFloat(form)  ;
                      }
                              if (ghiNhan == true){
                                      ghiNhan = false;
                              }
                              if (valid == false){
                              changeCursorDefault ();
                      }
                          return valid;
			
                      }
	  
		
        </script>
        <body onkeydown="enterToTab();">
            <h:form id="_form" name="_form" >

                <h:inputHidden id="mabankhamout_hid" value="#{B121_2_1_CapNhatKetQuaCLS.maBanKham}"/>
                <h:inputHidden id="matiepdonout_hid" value="#{B121_2_1_CapNhatKetQuaCLS.maTiepDon}"/>
                <h:inputHidden id="maclsout_hid" value="#{B121_2_1_CapNhatKetQuaCLS.clsmaOut}"/>

                <h:inputHidden id="imageTen_hid" value="#{B121_2_1_CapNhatKetQuaCLS.fileanh}"/>
                <h:inputHidden id="thatSuThucHien_hid" value="#{B121_2_1_CapNhatKetQuaCLS.thatSuThucHien}"/>

                <h:inputHidden id="hasImage_hid" value="#{B121_2_1_CapNhatKetQuaCLS.hasImage}"/>
				<h:inputHidden id="loaiCLS_hid" value="#{B121_2_1_CapNhatKetQuaCLS.loaiCLS}"/>
                <a4j:commandButton  style="display: none" id="refresh"
                                    action="#{B121_2_1_CapNhatKetQuaCLS.init()}"
                                    reRender="loaiCLS_hid,thatSuThucHien_hid,hasImage_hid,imageTen_hid,imageCLS,__ngaytg,DT_DM_BAN_KHAM_MA,__matiepdon,__mabenhnhan,__hoten,__tuoi,__donViTuoiHid,__macls,__tencls,__dathuchien,__kqcls,__hinhanh,__klcls"
                                    oncomplete="setOnload();hidImage();"
                                    />


                <div style="width:778px; position:absolute; z-index:99"></div>
                <table style="margin-top:3px" cellspacing="0" cellpadding="0" border="0" width="777">
                    <tr>
                        <td style="padding-top:5px" colspan="3" height="50px">
                            <table cellspacing="0" cellpadding="0" border="0" width="100%" >
                                <tr>
                                    <td height="50px" width="53%" style="padding-left: 18px; font-family: Arial; font-size: 18px; color: white; font-weight: bold;" >
                                        <h:graphicImage value="/images/white_light.gif" width="43" height="16" />
    						KẾT QUẢ CẬN LÂM SÀNG
                                    </td>
                                    <td valign="top">

                                        <table cellspacing="0" cellpadding="0" width="100%" >
                                            <tr>
                                                <td style="font-family: Arial; font-size: 12px; color: white; text-align: right; padding-right: 15px; padding-bottom: 2px; height: 25px; border-bottom: solid 1px #97989a;" valign="bottom" >
                                                    &#160;
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td width="13px" height="12px" class="mytdl">
                        </td>
                        <td style="background-color: #c9daea;" width="965px" height="12px" >
                        </td>
                        <td width="11px" height="12px" class="mytdr">
                        </td>
                    </tr>

                    <tr style=" height : 5px;">
                        <td width="100%" style="background-color: #c9daea; padding-top: 0px; padding-bottom: 0px" colspan="3" align="center">

                            <a4j:outputPanel id="message_infor">
                                <h:messages	styleClass="mynull"/>
                            </a4j:outputPanel>
                        </td>


                    </tr>

                    <tr>
                        <td colspan="3" style="background-color: #c9daea; padding-top: 0px; padding-bottom: 5px" width="100%" >
                            <!-- Main Area -->
                            <table cellspacing="5" cellpadding="0" border="0" width="100%">
                                <tr style="height: 25px;">
                                    <td align="right" >
                                        <h:outputText value="Bàn khám" styleClass="mytext" style="margin-right : 5px; margin-left : 5px"/>

                                    </td>
                                    <td align="left" >


                                        <h:inputText   styleClass="myinput"
                                                       id="DT_DM_BAN_KHAM_MA"  onblur="myOnblurTextbox(this.id,'DT_DM_BAN_KHAM')" name="DT_DM_BAN_KHAM_MA" style=" width : 50px" maxlength="10" />
                                        <span id="DT_DM_BAN_KHAM_span"/>
                                        <input  id="DT_DM_BAN_KHAM" name="DT_DM_BAN_KHAM" class="myinput" style=" width :262px;"/>


                                        <h:outputText value="Mã tiếp đón" styleClass="mytext" style="margin-right: 5px; margin-left:5px"/>
                                        <h:inputText

                                            id="__matiepdon" name="_matiepdon" style="width: 100px;" styleClass="myinput">

                                        </h:inputText>

                                    </td>

                                </tr>
                                <tr style="height: 25px;">
                                    <td align="right" width="20%">
                                        <h:outputText value="Mã bệnh nhân" styleClass="mytext" style="margin-right: 5px; margin-left:5px"/>

                                    </td>
                                    <td align="left" >
                                        <h:inputText readonly="true"
                                                     value="#{B121_2_1_CapNhatKetQuaCLS.maBenhNhan}"
                                                     id="__mabenhnhan" name="_mabenhnhan" style="float:left; width: 100px;" styleClass="myreadonly" />

                                        <h:outputText value="Họ tên" styleClass="mytext" style="float:left; margin-right : 5px; margin-left : 29px"/>
                                        <h:inputText readonly="true"
                                                     value="#{B121_2_1_CapNhatKetQuaCLS.tenBenhNhan}"
                                                     id="__hoten" name="_hoten" styleClass="myreadonly" style="float:left; width : 146px;"/>
                                        <h:outputText value="Tuổi" styleClass="mytext" style="float:left; margin-right: 5px; margin-left: 10px"/>
                                        <h:inputText readonly="true"  id="__tuoi"  value="#{B121_2_1_CapNhatKetQuaCLS.tuoi}" name="_tuoi" style="float:left; width : 20px; margin-right: 3px" styleClass="myreadonly"/>
                                        <h:outputText value="(Năm)" id="__donViTuoi" styleClass="mytext" style="margin-right: 3px; margin-left: 3px;float:left;"/>
                                        <h:inputHidden id = "__donViTuoiHid" value = "#{B121_2_1_CapNhatKetQuaCLS.donviTuoi}"/>
                                        <h:inputText readonly="true"  value="#{B121_2_1_CapNhatKetQuaCLS.ngaySinh}" onblur="return is_wellformed_Date(this)" type="text" id="__ngaytg" name="_ngaytg" maxlength="10" style="float:left; width : 70px;" styleClass="myreadonly"/>

                                    </td>

                                </tr>
                                <tr style="height: 25px;">
                                    <td align="right" width="20%">
                                        <h:outputText value="Mã CLS" styleClass="mytext" style="margin-right: 5px; "/>


                                    </td>
                                    <td align="left" >
                                        <h:inputText readonly="true"  value="#{B121_2_1_CapNhatKetQuaCLS.maCLS}" type="text" id="__macls" name="_macls" maxlength="10" style=" width : 70px;" styleClass="myreadonly"/>
                                        <h:outputText value="Tên CLS" styleClass="mytext" style="margin-left: 10px; margin-right: 5px; "/>
                                        <h:inputText readonly="true"  value="#{B121_2_1_CapNhatKetQuaCLS.tenCLS}" type="text" id="__tencls" name="_tencls" maxlength="10" style=" width : 450px;" styleClass="myreadonly"/>

                                    </td>

                                </tr>
                                <tr style="height: 25px;">
                                    <td align="right" width="20%">
                                        <h:outputText value="Đã thực hiện" styleClass="mytext" style="margin-right: 5px; "/>

                                    </td>
                                    <td align="left" >

                                        <h:selectBooleanCheckbox  title="Đã thực hiện" label="Đã thực hiện" id="__dathuchien"  value="#{B121_2_1_CapNhatKetQuaCLS.daThucHien}" style="float: left;"  tabindex="1">
                                        </h:selectBooleanCheckbox>
                                    </td>

                                </tr>
                                <tr style="height: 25px;">
                                    <td align="center" width="100%" colspan="2">
                                        <h:panelGroup  id="imageCLS">
                                            <c:if test='#{!B121_2_1_CapNhatKetQuaCLS.maKhoa.equals(app.KHOA_VISINH_MA)}'>
                                                <h:graphicImage  rendered="#{B121_2_1_CapNhatKetQuaCLS.hasImage}"    url="#{msg.VI_TRI_THU_MUC_ANH_CLS}/#{B121_2_1_CapNhatKetQuaCLS.fileanh}"/>
                                            </c:if>
                                            <c:if test='#{B121_2_1_CapNhatKetQuaCLS.maKhoa.equals(app.KHOA_VISINH_MA)}'>
                                                <h:outputLink value="#{msg.VI_TRI_THU_MUC_ANH_CLS}/#{B121_2_1_CapNhatKetQuaCLS.fileanh}" rendered="#{B121_2_1_CapNhatKetQuaCLS.hasImage}">Kết quả</h:outputLink>
                                            </c:if>
                                        </h:panelGroup>
                                    </td>


                                </tr>
                                <c:if test='#{identity.hasRole("NV_KhoaCLS") or identity.hasRole("QT_KhoaCLS") }'>
                                    <tr style="height: 25px;">
                                        <td align="right" width="20%">
                                            <h:outputText value="Chọn tập tin" styleClass="mytext" style="margin-right: 5px; "/>
                                        </td>
                                        <td align="left" >
                                            <rich:fileUpload  fileUploadListener="#{B121_2_1_CapNhatKetQuaCLS.listener}"
                                                              maxFilesQuantity="2"
                                                              acceptedTypes="*"
                                                              addControlLabel="Chon tap tin"
                                                              uploadControlLabel="Tai du lieu len"
                                                              cancelEntryControlLabel="huy"
                                                              doneLabel="Hoan thanh"
                                                              stopEntryControlLabel="Dung"
                                                              progressLabel="Dang thuc hien"
                                                              stopControlLabel="Dung"
                                                              transferErrorLabel="Tai khong thanh cong"
                                                              clearControlLabel="Xoa"
                                                              clearAllControlLabel="Xoa"
                                                              listHeight="80"
                                                              listWidth="500"
                                                              tabindex="2"
                                                              />

                                        </td>
                                    </tr>
                                </c:if>
                                <tr>
                                    <th colspan="2" align="right" style="margin-left: 30px;">
                                        <div id="replaceContent">
                                            <!-- Original HTML table here-->
                                        </div>
                                    </th>
                                </tr>
                                <tr style="display:none">
                                    <td align="right" width="20%">
                                        <h:outputText value="Dữ liệu chuẩn đoán hình ảnh" styleClass="mytext" style="margin-right: 5px; "/>
                                    </td>
                                    <td>
                                        <h:inputText value="#{B121_2_1_CapNhatKetQuaCLS.dulieuhinhanh}" type="text" id="__hinhanh" name="__hinhanh" style=" width : 500px;" />
                                    </td>
                                </tr>
                                <tr>
                                    <td align="right" width="20%">
                                        <h:outputText value="Kết quả máy xét nghiệm" styleClass="mytext" style="margin-right: 5px; "/>
                                    </td>
                                    <td>
                                        <h:inputTextarea value="#{B121_2_1_CapNhatKetQuaCLS.ghichu}" id="__klcls" style="height : 120px; width : 500px;" onkeydown="setEnableEntToTab(false)" onblur="setEnableEntToTab(true)" onkeyup="checkMaxLength(this,1020)"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td align="right" width="20%">
                                        <h:outputText value="Kết luận" styleClass="mytext" style="margin-right: 5px; "/>
                                    </td>
                                    <td>
                                        <h:inputTextarea value="#{B121_2_1_CapNhatKetQuaCLS.kqCLS}" id="__kqcls" name="_kqcls" style="height : 120px; width : 500px;" onkeydown="setEnableEntToTab(false)" onblur="setEnableEntToTab(true)" onkeyup="checkMaxLength(this,1020)"/>
                                    </td>
                                </tr>
                                <tr style="height: 25px;" >
                                    <td align="right" colspan="3" style="padding-left:250px; padding-bottom: 5px; padding-top: 5px;" >

                                        <c:if test='#{identity.hasRole("NV_KhoaCLS") or identity.hasRole("QT_KhoaCLS") }'>
                                            <div style="float: left;">
                                                <a4j:commandButton  id="__ghinhan"  name="_ghinhan" value="Ghi nhận"
                                                                    onclick="if (! onSubmit_ghinhan()) { this.alt = 0; return false; }"
                                                                    action="#{B121_2_1_CapNhatKetQuaCLS.ghinhan}"
                                                                    oncomplete='changeCursorDefault(); this.alt = 0;'
                                                                    style="width: 70px;margin-right: 3px;"
                                                                    reRender="thatSuThucHien_hid,message_infor,__dathuchien"
                                                                    styleClass="mybton_b" />
                                            </div>
                                        </c:if>
                                        <div id="divQuaylai" style="float: left;">
                                            <a4j:commandButton  id="__quaylai" name="_quaylai"  value="Quay lại"
                                                                onclick="return trove();" style="width: 70px; margin-right: 3px;"
                                                                styleClass="mybton_b" />
                                        </div>


                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>

            </h:form>
        </body>
        <script type="text/javascript" src="#{facesContext.externalContext.requestContextPath}/resources/ThietBiYKhoa/swfobject.js"></script>
        <script type="text/javascript" src="#{facesContext.externalContext.requestContextPath}/resources/gears/dieutri/tiepdon/B121_2_Canlamsangphauthuat_kqcls_gears.js"></script>
        <iframe width="174" height="189" name="gToday:normal:agenda.js" id="gToday:normal:agenda.js" src="#{facesContext.externalContext.requestContextPath}/resources/calendar/ipopeng.htm" scrolling="no" frameborder="0" style="visibility:visible; z-index:999; position:absolute; top:-500px; left:-500px;"/>


    </ui:define>
</ui:composition>


