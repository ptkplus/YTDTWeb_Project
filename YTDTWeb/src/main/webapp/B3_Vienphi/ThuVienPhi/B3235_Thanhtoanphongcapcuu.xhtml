<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:s="http://jboss.com/products/seam/taglib"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:c="http://java.sun.com/jstl/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:rich="http://richfaces.org/rich"
                xmlns:a4j="http://richfaces.org/a4j"
                template="/layout/mytemplate.xhtml">

<ui:define name="body">	

<f:loadBundle var="msg" basename="com.iesvn.yte.UIResources" />
	<script type="text/javascript">
    	function enterToTab(){
		
		  		  if(	(document.getElementById(prefix_component + "__tieptucnhap") == null || document.getElementById(prefix_component + "__tieptucnhap").alt != 1 ) &amp;&amp; 
		          	 	(document.getElementById(prefix_component + "__inPhieu") ==null || document.getElementById(prefix_component + "__inPhieu").alt != 1 ) &amp;&amp; 
		           		(document.getElementById(prefix_component + "__ghinhan") == null ||document.getElementById(prefix_component + "__ghinhan").alt  != 1  ) 
		           ) {
		           
		                  if(window.event.keyCode == 13){
		                         window.event.keyCode = 9;
		                   }
		           }
		}
		var bCancel = false;
		var bSave = false;
		
		function setSave() {
			bSave = true;
		}
		function setCancel(){
			bCancel = true;
		}		
		
		function iesvn_Required() {
			this.aa = new Array(prefix_component + "__matiepdon", "<h:outputFormat value='#{msg.common_requireField}' > <f:param value='Mã tiếp đón'/> </h:outputFormat>", new Function ("varName",  "return this[varName];"));
			this.ab = new Array(prefix_component + "DT_DM_NHAN_VIEN_1", "<h:outputFormat value='#{msg.common_requireField}' > <f:param value='Thu ngân'/> </h:outputFormat>", new Function ("varName",  "return this[varName];"));
 	 		}
		
		

		function iesvn_ComparedDates() {
			this.aa = new Array([prefix_component + "__ngay",prefix_component + "__ngayhientai", "=="], "<h:outputFormat value='#{msg.common_compareCurDate}' > <f:param value='Ngày thanh toán'/> </h:outputFormat>", new Function ("varName", "this.datePatternStrict='dd/MM/yyyy';  return this[varName];"));
		}
		
		
		
		function iesvn_FloatValidations(){
			this.aa = new Array(prefix_component + "__thatthu", 
								"<h:outputFormat value='#{msg.common_float}'><f:param value='Thất thu' /></h:outputFormat>", 
								new Function ("varName",  "return this[varName];"));
		}
		
		function onSubmitTmp(){
			setSave() ;
			return onSubmit();
		}
		
		function onSubmit() {
			
			var form = document.forms[0];
			var valid = true;			
			if (bSave){
		    	bSave = false;	    	    	
		    	valid = iesvn_ValidateRequired(form)  ; 
		    	 	
		    	if (valid == true){		    		
		    		valid = iesvn_ValidateComparedDates(form);		    			
		    	}
		    	
		    	if (valid == true){		    		
		    		valid = iesvn_ValidateFloat(form);		    			
		    	}
		    	  
		    } 	    	    
		    if (bCancel){
		    	bCancel = false;
		    }
		    return valid;
		}
		function checkEmpty(id){
			if ( document.getElementById(id).value == null || document.getElementById(id).value == "" ){
			
				if(document.getElementById(id).className.match(/focus/gi))
              		document.getElementById(id).className = document.getElementById(id).className.replace(/focus/gi,"");
				return false;
			}
			return true;
		}	
		
		function checkTienBNTra(textbox) {			
			var nguonkhac = textbox.value;
			if(iesvn_Trim(nguonkhac) == '') {
				nguonkhac = "0";
				textbox.value = 0;
			}						
			var tmp = parseFloat(nguonkhac.replace(/,/g,""));
			var hid_nguonkhac = parseFloat(document.getElementById(prefix_component + "hid_nguonkhactra").value);
			var hid_benhnhan = parseFloat(document.getElementById(prefix_component + "hid_benhnhantra").value);
			//alert("tmp = " +  tmp + ", hid_benhnhan = " + hid_benhnhan + ", sub = " + (hid_benhnhan - tmp));
			var sub = hid_benhnhan - tmp;
			var sub_conlai = hid_conlai - tmp;
			//alert("sub = " + sub + ", fix2 = " + sub.toFixed(2) + ", fix3 = " + sub.toFixed(3));
			if ((tmp - hid_benhnhan ) > 0) {
				alert("Số tiền nguồn khác trả không hợp lệ");
				textbox.value = hid_nguonkhac;
				document.getElementById(prefix_component + "__sodu").value = (hid_benhnhan - hid_nguonkhac);
				document.getElementById(prefix_component + "__conlai").value = (hid_conlai - hid_nguonkhac);
				numberFormatBlur(textbox);	
				numberFormatBlur(document.getElementById(prefix_component + "__sodu"));
				numberFormatBlur(document.getElementById(prefix_component + "__conlai"));			
			} else {
				document.getElementById(prefix_component + "__sodu").value = sub;  // sub.toFixed(2);
				document.getElementById(prefix_component + "__conlai").value = sub_conlai;  //sub_conlai.toFixed(2);
				numberFormatBlur(document.getElementById(prefix_component + "__sodu"));
				numberFormatBlur(document.getElementById(prefix_component + "__conlai"));
			}
		}
		function checkValidDot(textbox) {	
			var e = window.event;
			if(e.keyCode == 46) {
				if (textbox.value.indexOf(".") != -1) e.keyCode = 0;
			}
		}
	</script>
	<body onkeydown="enterToTab();">
	<h:form id="_form" name="_form">
	<h:inputHidden value="#{B3235_Thanhtoanphongcapcuu.isUpdate}" id="isUpdate" />
	
	<h:inputHidden value="#{B3235_Thanhtoanphongcapcuu.formTitle}" id="tenChuongTrinh" />
	<h:inputHidden value="#{YTDT_Menu.tiepNhanKhamBenh}" id="tiepNhanKhamBenh" />
	
    <h:inputHidden id="__ngayhientai" value="#{B3235_Thanhtoanphongcapcuu.ngayHt}"/>
    <div style="width:778px; position:absolute" id="div_mymenu_YTDT_TiepDon">
	    <c:if test='#{B3235_Thanhtoanphongcapcuu.formTitle.equals(YTDT_Menu.thuVienPhi) or B3235_Thanhtoanphongcapcuu.formTitle.equals("VP")}'>            	
	    	<ui:include  src="/layout/mymenu_YTDT_VienPhi_ThuVienPhi.xhtml" />    	      
	    </c:if>
	    <c:if test="#{B3235_Thanhtoanphongcapcuu.formTitle.equals(YTDT_Menu.tiepNhanKhamBenh)}">        	
	    	<ui:include src="/layout/mymenu_YTDT_TiepDon.xhtml" />    	    
	    </c:if>
    </div>
   
    <table style="margin-top:20px" cellspacing="0" cellpadding="0" border="0" width="777">
    	<tr>
    		<td colspan="3" height="50px">
    			<table cellspacing="0" cellpadding="0" border="0" width="100%" >
    				<tr>
    					<td height="50px" width="45%" style="padding-left: 18px; font-family: Arial; font-size: 18px; color: white; font-weight: bold;" >    			
    						<h:graphicImage value="/images/white_light.gif" width="43" height="16" />
    						 <c:if test="#{B3235_Thanhtoanphongcapcuu.formTitle.equals(YTDT_Menu.thuVienPhi)}">
    						THANH TOÁN PHÒNG CẤP CỨU
    						</c:if>
    						
    						<c:if test='#{B3235_Thanhtoanphongcapcuu.formTitle.equals(YTDT_Menu.tiepNhanKhamBenh) or B3235_Thanhtoanphongcapcuu.formTitle.equals("VP")}'>
    							XEM CHI PHÍ ĐIỀU TRỊ
    						</c:if>
    					</td>
    					<td valign="top">
    					<table cellspacing="0" cellpadding="0" width="100%" >
    						<tr>
    							<td style="font-family: Arial; font-size: 12px; color: white; text-align: right; padding-right: 15px; padding-bottom: 2px; height: 25px; border-bottom: solid 1px #97989a;" valign="bottom" >
    								&#160;
    							</td>
    						</tr>
    					</table> 
    					</td>
    				</tr>
    			</table>			
    		</td>    		    	
    	</tr>    
    	<tr>
    		<td width="13px" height="12px" class="mytdl">    			
    		</td>
    		<td align="center" style="background-color: #c9daea;" width="965px" height="12px" > 
    			
    		</td>
    		<td width="11px" height="12px" class="mytdr">    			
    		</td>
    	</tr>
    	<tr style=" height : 5px;">
    		<td width="100%" style="background-color: #c9daea; padding-top: 0px; padding-bottom: 0px" colspan="3" align="center">  
    		      	<a4j:outputPanel id="__message">
					<h:messages styleClass="mynull" />
				</a4j:outputPanel>
    		</td>    		
    	</tr>
    	<tr>
    		<td colspan="3" style="background-color: #c9daea; padding-top: 10px; padding-bottom: 15px" width="100%" >
    			<!-- Main Area -->    		
    			<table cellspacing="0" cellpadding="0" border="0" width="100%" >
    				<tr style="height: 25px;">
    					<td align="right" style="width:14%; padding-left: 0px;">
    					<h:outputText value="Số phiếu" styleClass="mytext" style="margin-right: 5px; margin-left: 23px;"/>
    					
    					</td>
    					<td align="left" style="padding-right: 0px;" >
    						<h:inputText value="#{B3235_Thanhtoanphongcapcuu.hsttk.hsthtoankMa}"  
    						maxlength="15" onkeypress="iesvn_InputInKeys('0123456789')" id="__sophieu" name="_sophieu" style="width: 120px;" styleClass="myinput" tabindex="1">
    							<a4j:support event="onblur" action="#{B3235_Thanhtoanphongcapcuu.loadMaPhieu}" 
    							onsubmit="if (! checkEmpty(prefix_component + '__sophieu')) { return false; } "
    								reRender="__namsinhHid,DM_DAN_TOC,DM_NGHE_NGHIEP,DM_TINH,DM_HUYEN,DM_XA,DM_DOI_TUONG,isUpdate,__message,__matiepdon, __giuongso, __gio, __ngay, __hoten, __gioitinh, __tuoi, __donViTuoiHid, __ngaysinh, __sinhtai, __madantoc, __manghenghiep, TINH_MA, HUYEN_MA, XA_MA, __sonha, __bhyt5, __madoituong, __thuoc1, __thuoc2, __vtth1, __vtth2, __cls1, __cls2, __phauthuat1, __phauthuat2, __phong1, __phong2, __tongchi1, __tongchi2, __khongthu2, __ungtra, __thatthu, __xetgiam, __dienmien, __lydo, __thanhtoan, __bienlai1, __bienlai2, __bienlai3,__ngansach,__khongthu1,__sodu,DT_DM_NHAN_VIEN_1,__conlai,__listClsKham,__listTPK"
    								oncomplete="displayInphieu()"/>
							
    						</h:inputText>  
    						<h:outputText value="Thu ngân" styleClass="mytext" style="margin-right: 5px; margin-left: 103px;"/>
    						<h:inputText readonly="true"  value="#{B3235_Thanhtoanphongcapcuu.nhanVienThungan.dtdmnhanvienTen}" id="DT_DM_NHAN_VIEN_1"  style="width: 230px;" styleClass="myreadonly" onkeydown="return disabledBackSpace();" />
    					</td>
    				</tr>
    				<tr style="height: 25px;">
    					<td align="right"  style="width: 13%; padding-right: 0px;">
    						<h:outputText value="Mã tiếp đón" styleClass="mytext" style="margin-left: 5px; margin-right: 5px"/>
    						
    					</td>
    					<td  align="left" colspan="3" style="padding-right: 0px;">
    						<h:inputText tabindex="1" value="#{B3235_Thanhtoanphongcapcuu.maTiepDon}" id="__matiepdon" name="_matiepdon" style=" width : 120px;" styleClass="myinput">
    							<a4j:support action="#{B3235_Thanhtoanphongcapcuu.loadTiepDon()}" event="onchange" focus="__gio" oncomplete="onCompleteLoadTiepDon()" 
    							reRender="__namsinhHid,DM_DAN_TOC,DM_NGHE_NGHIEP,DM_TINH,DM_HUYEN,DM_XA,DM_DOI_TUONG,isUpdate,__message,__matiepdon, __giuongso, __gio, __ngay, __hoten, __gioitinh, __tuoi, __donViTuoiHid, __ngaysinh, __sinhtai, __madantoc, __manghenghiep, TINH_MA, HUYEN_MA, XA_MA, __sonha, __bhyt5, __madoituong, __thuoc1, __thuoc2, __vtth1, __vtth2, __cls1, __cls2, __phauthuat1, __phauthuat2, __phong1, __phong2, __tongchi1, __tongchi2, __khongthu2, __ungtra, __thatthu, __xetgiam, __dienmien, __lydo, __thanhtoan, __bienlai1, __bienlai2, __bienlai3,__ngansach,__khongthu1,__sodu,__sophieu,__conlai,__listClsKham,__listTPK,__nguonkhactra,hid_nguonkhactra,hid_benhnhantra,hid_conlai"></a4j:support>
    						</h:inputText>
    				    	<h:outputText value="*" styleClass="mynull"
								style=" margin-left: 2px;margin-right: 5px;" />
								<button name="_goiBN" id="__goiBN" value="Gọi BN" onclick="goiBN('__matiepdon', '__hoten');" type="button">Gọi BN</button>
    						<applet code="com.iesvn.test.testapplet.ClientQuangBaoApplet.class" archive="ClientQuangBao.jar"
width="1" height="1" id="xyz" name="xyz"></applet>
    						<h:outputText value="Thời điểm" styleClass="mytext" style="margin-left: 20px; margin-right: 5px"/>
    						<h:inputText tabindex="2" value="#{B3235_Thanhtoanphongcapcuu.gioHt}" id="__gio" name="_gio" 
    						style=" width : 35px;" styleClass="myinput" onkeypress="iesvn_InputInKeys('1234567890:');" onkeyup="checkHour(this);" 
    						onblur='if(this.className.match(/focus/gi))    this.className = this.className.replace(/focus/gi,""); checkHourBlur(this)'/>
    						<h:inputText value="#{B3235_Thanhtoanphongcapcuu.ngayHt}" onkeypress="return being_wellformed_Date(this, event)" 
    						onblur='if(this.className.match(/focus/gi))    this.className = this.className.replace(/focus/gi,""); return is_wellformed_Date(this)' tabindex="3" type="text" id="__ngay" name="_ngay" maxlength="10" style="width:70px" class="myinput"/><a hideFocus="true" onclick="if(self.gfPop)gfPop.fPopCalendar(document.getElementById(prefix_component + '__ngay'));document.getElementById(prefix_component + '__bienlai1').focus();return false;" href="javascript:void(0)">
    							<h:graphicImage value="/resources/calendar/cal.gif" style="margin:0 0 -3px 0" border="0" name="popcal"/>
    						</a>	
							
							
    					</td>
    				</tr>
    				<tr style="height: 25px;" >
    					<td align="right"> 
    						<h:outputText value="Họ tên" styleClass="mytext" style="margin-left: 5px; margin-right: 5px"/>
    						
    					</td>
    					<td  align="left"  colspan="3">
    						<table cellspacing="0" cellpadding="0" border="0" width="100%">
	    					<tr>
	    					<td align="left" width="15%">
	    						<h:inputText readonly="true" value="#{B3235_Thanhtoanphongcapcuu.tiepDon.getBenhnhanMa(true).benhnhanHoten}" id="__hoten" name="_hoten" style="float: left; width : 193px;" styleClass="myreadonly"/>
	    					</td>
	    					<td align="left" width="35%">
	    						<h:outputText value="Giới tính" styleClass="mytext" style="float: left; padding-top:3px; margin-left: 25px; margin-right: 0px;"/>
	    						<h:selectOneRadio disabled="true" value="#{B3235_Thanhtoanphongcapcuu.tiepDon.getBenhnhanMa(true).getDmgtMaso(true).dmgtMa}" id="__gioitinh">
						        	<f:selectItem id="__namItems" itemValue="1" itemLabel="Nam" styleClass="mycheck"   />					    
						        	<f:selectItem id="__nuItems" itemValue="0" itemLabel="Nữ" styleClass="mycheck" />
						    	</h:selectOneRadio>
	    					</td>
	    					<td align="left">
		    					<h:outputText value="Tuổi" styleClass="mytext" style=" margin-left:12px; margin-right: 4px;"/>
	    						<h:inputText readonly="true"  value="#{B3235_Thanhtoanphongcapcuu.tiepDon.getBenhnhanMa(true).benhnhanTuoi}" id="__tuoi" name="_tuoi" style="margin-left: 0px; margin-right: 3px; width : 30px;" styleClass="myreadonly"/>
	    						
	    						<h:outputText value="(Năm)" id="__donViTuoi" styleClass="mytext" style="margin-left: 1px;margin-right: 3px;"/> 		
	    						<h:inputHidden id = "__donViTuoiHid" value = "#{B3235_Thanhtoanphongcapcuu.tiepDon.getBenhnhanMa(true).benhnhanDonvituoi}"/>
	    						
	    						<h:inputHidden id = "__namsinhHid" value= "#{B3235_Thanhtoanphongcapcuu.tiepDon.getBenhnhanMa(true).benhnhanNamsinh}"/>
	    				
	    				
	    						<h:inputText readonly="true" value="#{B3235_Thanhtoanphongcapcuu.ngaySinh}" onkeypress="return being_wellformed_Date(this, event)" onblur="return is_wellformed_Date(this)" type="text" id="__ngaysinh" name="_ngaysinh" maxlength="10" style=" width : 70px;" styleClass="myreadonly"/><a hideFocus="true" href="javascript:void(0)"  >
	    							<h:graphicImage value="/resources/calendar/cal.gif" style="margin:0 0 -3px 0" border="0" name="popcal"/>
	    						</a>	
	    					</td>
	    				</tr>
	    			</table>
    					</td>
    				</tr>
    				<tr style="height: 25px;">
    					<td align="right"  style="padding-right: 0px;">
    						<h:outputText value="Dân tộc" styleClass="mytext" style="margin-left: 5px; margin-right: 5px"/>
    						
    					</td>
    					<td  align="left" colspan="3" style="padding-right: 0px;">
    						
    						<h:inputText readonly="true" tabindex="16" value="#{B3235_Thanhtoanphongcapcuu.tiepDon.getBenhnhanMa(true).getDantocMa(true).dmdantocMa}" id="__madantoc" name="_madantoc" style="width: 45px;" styleClass="myreadonly" 
    						/>
    						<h:inputText readonly="true" tabindex="16" value="#{B3235_Thanhtoanphongcapcuu.tiepDon.getBenhnhanMa(true).getDantocMa(true).dmdantocTen}" id="DM_DAN_TOC" name="DM_DAN_TOC" style="width: 143px; margin-left:3px;" styleClass="myreadonly" 
    						/>
    					
    					</td>
    				</tr>
    				<tr style="height: 25px;">
    					<td align="right"  style="padding-right: 0px;">
    							
    						<h:outputText value="Nghề nghiệp" styleClass="mytext" style="margin-left: 9px; margin-right: 5px"/>
    						
    					</td>
    					<td  align="left" colspan="3" style="padding-right: 0px;">
    						
    						
    						<h:inputText readonly="true" value="#{B3235_Thanhtoanphongcapcuu.tiepDon.getBenhnhanMa(true).getBenhnhanNghe(true).dmnghenghiepMa}" tabindex="11" id="__manghenghiep" name="_manghenghiep" style="width: 45px;" styleClass="myreadonly"/>
    						<h:inputText readonly="true" value="#{B3235_Thanhtoanphongcapcuu.tiepDon.getBenhnhanMa(true).getBenhnhanNghe(true).dmnghenghiepTen}" tabindex="11" id="DM_NGHE_NGHIEP" name="DM_NGHE_NGHIEP" style="width: 143px; margin-left:3px;" styleClass="myreadonly" />
    						
    					</td>
    				</tr>
    				<tr style="height: 25px;">
    					<td align="right"  style="padding-right: 0px;">
    					<h:outputText value="Địa chỉ" styleClass="mytext"/>&#160;&#160;
    							
    					</td>
    					<td  align="left" colspan="3" style="padding-right: 0px;">
    					
    					<h:inputText  readonly="true" value="#{B3235_Thanhtoanphongcapcuu.tiepDon.getBenhnhanMa(true).getTinhMa(true).dmtinhMa}" id="TINH_MA" name="_TINH_MA" style=" width : 30px" styleClass="myreadonly"  />
    					<h:inputText  readonly="true" value="#{B3235_Thanhtoanphongcapcuu.tiepDon.getBenhnhanMa(true).getTinhMa(true).dmtinhTen}" id="DM_TINH" name="DM_TINH" style=" width : 158px; margin-left:3px;" styleClass="myreadonly" />
    					
    					<h:inputText readonly="true" value="#{B3235_Thanhtoanphongcapcuu.tiepDon.getBenhnhanMa(true).getHuyenMa(true).dmhuyenMa}" id="HUYEN_MA" name="_HUYEN_MA" style=" width : 45px; margin-left:3px;" styleClass="myreadonly" />
    					<h:inputText readonly="true" value="#{B3235_Thanhtoanphongcapcuu.tiepDon.getBenhnhanMa(true).getHuyenMa(true).dmhuyenTen}" id="DM_HUYEN" name="DM_HUYEN" style=" width : 163px; margin-left:3px;" styleClass="myreadonly"/>
    					   				
    					<h:inputText  readonly="true" value="#{B3235_Thanhtoanphongcapcuu.tiepDon.getBenhnhanMa(true).getXaMa(true).dmxaMa}" id="XA_MA" name="_XA_MA" style=" width : 70px; margin-left:3px;" styleClass="myreadonly"  />
    					<h:inputText  readonly="true" value="#{B3235_Thanhtoanphongcapcuu.tiepDon.getBenhnhanMa(true).getXaMa(true).dmxaTen}" id="DM_XA" name="DM_XA" style=" width : 136px; margin-left:3px;" styleClass="myreadonly"  />
    					
    					
    					</td>
    				</tr>
    				<tr style="height: 25px;">
    					<td align="right"  style="padding-right: 0px;">
    					&#160;
    							
    					</td>
    					<td  align="left" colspan="3" style="padding-right: 0px;">
    					<h:inputText readonly="true" value="#{B3235_Thanhtoanphongcapcuu.tiepDon.getBenhnhanMa(true).benhnhanDiachi}" id="__sonha" name="_sonha" style=" width : 627px;" styleClass="myreadonly" />
    					
    					</td>
    				</tr>
    				<tr style="height: 25px;">
    					<td align="right" style=" padding-right: 0px;">
    					 
    					<h:outputText value="Đối tượng" styleClass="mytext" style="margin-left: 15px; margin-right: 5px"/>
    						
    					</td>
    					<td align="left" style="width: 70%; padding-left: 0px;">
    					<h:inputText readonly="true" value="#{B3235_Thanhtoanphongcapcuu.tiepDon.getDoituongMa(true).dmdoituongMa}" id="__madoituong" style="width : 45px" styleClass="myreadonly" />
    					<h:inputText readonly="true" value="#{B3235_Thanhtoanphongcapcuu.tiepDon.getDoituongMa(true).dmdoituongTen}" id="DM_DOI_TUONG" style="width : 143px; margin-left:3px;" styleClass="myreadonly" />
    					
    					<h:outputText value="Thẻ BHYT/nghèo" styleClass="mytext" style="margin-left: 25px; margin-right: 5px"/>
    						
    						
    					<h:inputText readonly="true" value="#{B3235_Thanhtoanphongcapcuu.tiepDon.tiepdonSothebh}" id="__bhyt5" name="_bhyt5" style=" width : 120px;" styleClass="myreadonly"/>
    					
    					
    					
    					
    					</td>
    					
    				</tr>
    			</table>					
    		</td>
    	</tr>	
    	<tr>
    		<td colspan="3" style="background-color: white; padding-top: 15px; padding-bottom: 15px;" width="100%" align="center">
    			<!-- Detail Area -->
    			<table cellspacing="0" cellpadding="0" border="0" width="90%" >
    				<tr style="height: 25px;">    					
    					<td  colspan="4">
    						<rich:dataTable headerClass="mycol" id="__listClsKham" rowClasses="myrow1,myrow2"
	                          styleClass="myTable" value="#{B3235_Thanhtoanphongcapcuu.listCLSKham}" var="currentRow" width="100%" bgcolor="#cccccc">
	                        <rich:column id="column_STT" >
	                        	<f:facet name="header"><h:outputText value="STT" /> </f:facet>	                        	
	                            <h:outputText id="outputText26" value="#{listCLS_XuatHangChoBNBHYT.rowIndex + 1}"/>                 
	                        </rich:column>
	                        
	                        <rich:column id="column_loai">
	                        	<f:facet name="header"><h:outputText value="Loại" /> </f:facet>	                        	
                                <h:outputText id="clskhamloai" value="#{currentRow.clskhamLoai}" /> 
	                        </rich:column>
	                        
	                        <rich:column id="column_maso">
	                        	<f:facet name="header"><h:outputText value="Mã số" /> </f:facet>  	                        	                                                 
	                             <h:outputText id="maso" value="#{currentRow.clskhamMahang.dtdmclsbgMa}" />          
	                        </rich:column>
	                        
	                        <rich:column id="column_diengiai" align="left"> 
	                        	<f:facet name="header"><h:outputText value="Tên CLS, PT, TT" /> </f:facet> 	                        	                                                
	                        	<h:outputText id="tencls" value="#{currentRow.clskhamMahang.dtdmclsbgDiengiai}" />  
	                        </rich:column>
	                        
	                       	                       
	                        <rich:column id="column_mp">
	                        	<f:facet name="header"><h:outputText value="MP" /> </f:facet>  	                        	                                                
	                             <h:outputText id="mp_table"  value="#{currentRow.clskhamMien == true?'x':''}" />          
	                        </rich:column>
	                        
	                        <rich:column id="column_yc">
	                        	<f:facet name="header"><h:outputText value="YC" /> </f:facet>   	                        	                                                 
	                             <h:outputText id="yeucau_table" value="#{currentRow.clskhamYeucau== true?'x':''}" />          
	                        </rich:column>
	                        <rich:column id="column_ktc">
	                        	<f:facet name="header"><h:outputText value="KTC" /> </f:facet>   
	                             <h:outputText id="kythuatcao_table" value="#{currentRow.clskhamKtcao== true?'x':''}" />          
	                        </rich:column>
	                        <rich:column id="column_soluong" align="right">
	                        	<f:facet name="header"><h:outputText value="SL" /> </f:facet>  	                        	                                                
	                             <h:outputText id="soluong_table" value="#{currentRow.clskhamLan}" ><f:converter converterId="com.iesvn.yte.converter.LongDoubleConverter" /></h:outputText>          
	                        </rich:column>
	                        <rich:column id="column_dongia" align="right">
	                        	<f:facet name="header"><h:outputText value="Đơn giá" /> </f:facet>  	                        	                                              
	                             <h:outputText id="dongia_table" value="#{currentRow.clskhamDongia}" ><f:converter converterId="com.iesvn.yte.converter.LongDoubleConverter" /></h:outputText>          
	                        </rich:column>
	                        
	                       
	                    </rich:dataTable>
    					</td>
    				</tr>
    				<tr style="height: 25px;">    					
    					<td  colspan="4">
    					</td>
    				</tr>
    				<tr style="height: 25px;">    					
    					<td  colspan="4">
    						<rich:dataTable id="__listTPK"  width="90%" value="#{B3235_Thanhtoanphongcapcuu.listTPK}" var="thuoc" align="center" border="0" cellpadding="0" cellspacing="0"
			    				headerClass="mycol" rowClasses="myrow1,myrow2" bgcolor="#cccccc" >
			    				<rich:column align="center" >
			    					<f:facet name="header"><h:outputText value="STT" /> </f:facet>    					
			    					<h:outputText value="#{B3235_Thanhtoanphongcapcuu.listTPK.indexOf(thuoc) + 1}" style="padding-left: 3px;" />
			    				</rich:column>
			    				<rich:column align="center" >
			    					<f:facet name="header"><h:outputText value="Mã số" /> </f:facet>    						
			    					<h:outputText value="#{thuoc.thuocphongkhamMathuoc.dmthuocMa}" style="padding-left: 3px;" />				
			    				</rich:column>
			    				<rich:column align="left" >    					
			    					<f:facet name="header"><h:outputText value="Tên thuốc, quy cách" /> </f:facet>
			    					<h:outputText value="#{thuoc.thuocphongkhamMathuoc.dmthuocTen}" style="padding-left: 3px;" />
			    				</rich:column>
			    				<rich:column align="center" >
			    					<f:facet name="header"><h:outputText value="NSX" /> </f:facet>    					
			    					<h:outputText value="#{thuoc.getThuocphongkhamQuocgia(true).dmquocgiaMa}" style="padding-left: 3px;" />
			    				</rich:column>
			    				<rich:column align="center" >
			    					<f:facet name="header"><h:outputText value="HSX" /> </f:facet>    					
			    					<h:outputText value="#{thuoc.getThuocphongkhamHangsx(true).dmnhasanxuatTen}" style="padding-left: 3px;" />
			    				</rich:column>
			    				<rich:column align="right" >
			    					<f:facet name="header"><h:outputText value="Số lượng" /> </f:facet>    					
			    					<h:outputText value="#{thuoc.thuocphongkhamSoluong}" style="padding-left: 3px;" >
			    					<f:converter converterId="com.iesvn.yte.converter.DoubleConverter2FractionDigits" />
			    					</h:outputText>
			    				</rich:column>
			    					
			    				<rich:column align="right" >
			    					<f:facet name="header"><h:outputText value="Đơn giá" /> </f:facet>    					
			    					<h:outputText value="#{thuoc.thuocphongkhamDongiatt}" style="padding-left: 3px;" >			    						
			    					</h:outputText>
			    				</rich:column>
			    				<rich:column align="right" style="padding-right:17px;" >
			    					<f:facet name="header"><h:outputText value="Thành tiền" /> </f:facet>    					
			    					<h:outputText value="#{thuoc.thuocphongkhamThanhtien}" style="padding-left: 3px;" >
			    						
			    					</h:outputText>
			    				</rich:column>
			    				
			    				
			    			</rich:dataTable>
    					</td>
    				</tr>
    				<tr style="height: 25px;">    					
    					<td  colspan="4">
    					</td>
    				</tr>	
    				<tr style="height: 25px;">    					
    					<td  align="right">
    						&#160;
    					</td>
    					<td align="right">
    						<h:outputText value="Ngoài DM                Danh mục TT     " styleClass="mytext"/>
    						
    					</td>
    					<td align="right" style="padding-right: 5px;" >
    						<h:outputText value="Ứng-trả" styleClass="mytext"/>
    					</td>   
    					<td align="left" style="padding-right: 15px;">    						
    						
    						<h:inputText readonly="true" value="#{B3235_Thanhtoanphongcapcuu.ungTra}"  id="__ungtra" name="_ungtra" style="width: 70px;" styleClass="myreadonlyso"><f:converter converterId="com.iesvn.yte.converter.LongDoubleConverter" /></h:inputText>
    					
    					</td> 					
    				</tr>
    				<tr style="height: 25px;">    					
    					<td  align="right">
    						&#160;
    					</td>
    					<td align="right">
    						<h:outputText value="Thuốc" styleClass="mytext"/>&#160;&#160;
    						<h:inputText readonly="true" value="#{(B3235_Thanhtoanphongcapcuu.hsttk.hsthtoankThuocndm eq null) ? '0' : B3235_Thanhtoanphongcapcuu.hsttk.hsthtoankThuocndm}"  id="__thuoc1" name="_thuoc1" style="width: 100px;" styleClass="myreadonlyso"><f:converter converterId="com.iesvn.yte.converter.LongDoubleConverter" /></h:inputText>&#160;
    						<h:inputText readonly="true" value="#{(B3235_Thanhtoanphongcapcuu.hsttk.hsthtoankThuoc eq null) ? '0' : B3235_Thanhtoanphongcapcuu.hsttk.hsthtoankThuoc}"  id="__thuoc2" name="_thuoc2" style="width: 100px;" styleClass="myreadonlyso"><f:converter converterId="com.iesvn.yte.converter.LongDoubleConverter" /></h:inputText>
    					
    					</td>
    					<td align="right" style="padding-right: 5px;" >
    						<h:outputText value="BN trả" styleClass="mytext"/>
    						
    					</td>   
    					<td align="left" style="padding-right: 15px;">    						
    						
    						<h:inputText readonly="true" value="#{B3235_Thanhtoanphongcapcuu.bntra}"  id="__sodu" name="_sodu" style="width: 70px;" styleClass="myreadonlyso"><f:converter converterId="com.iesvn.yte.converter.LongDoubleConverter" /></h:inputText>
    					
    					</td> 					
    				</tr>
    				<tr style="height: 25px;">
    					<td align="right" style="padding-right: 0px">
    						&#160;
    					</td>
    					<td align="right" style="padding-right: 0px">
    						<h:outputText value="VTTH" styleClass="mytext"/>&#160;&#160;
    						<h:inputText readonly="true"  value="#{(B3235_Thanhtoanphongcapcuu.hsttk.hsthtoankVtthndm eq null) ? '0' : B3235_Thanhtoanphongcapcuu.hsttk.hsthtoankVtthndm}" id="__vtth1" name="_vtth1" style="width: 100px;" styleClass="myreadonlyso"><f:converter converterId="com.iesvn.yte.converter.LongDoubleConverter" /></h:inputText>&#160;
    						<h:inputText readonly="true"  value="#{(B3235_Thanhtoanphongcapcuu.hsttk.hsthtoankVtth eq null) ? '0' : B3235_Thanhtoanphongcapcuu.hsttk.hsthtoankVtth}" id="__vtth2" name="_vtth2" style="width: 100px;" styleClass="myreadonlyso"><f:converter converterId="com.iesvn.yte.converter.LongDoubleConverter" /></h:inputText>
    					
    					</td>
    					<td align="right" style="padding-right: 5px;">    						
    					<h:outputText value="Thất thu, xét miễn" styleClass="mytext"/>	
    					</td>
    					<td align="left" style="padding-right: 15px">
    						<h:inputText  value="#{B3235_Thanhtoanphongcapcuu.hsttk.hsthtoankThatthu}" tabindex="4" id="__thatthu" name="_thatthu" style="width: 70px;margin-right:3px" styleClass="myinputso"><f:converter converterId="com.iesvn.yte.converter.LongDoubleConverter" /></h:inputText>
    						<h:inputText readonly="true" value="#{(B3235_Thanhtoanphongcapcuu.hsttk.hsthtoankXetgiam eq null) ? '0' : B3235_Thanhtoanphongcapcuu.hsttk.hsthtoankXetgiam}"  id="__xetgiam" name="_thatthu" style="width: 70px;" styleClass="myreadonlyso"><f:converter converterId="com.iesvn.yte.converter.LongDoubleConverter" /></h:inputText>
    						
    					</td>
    				</tr>
    				<tr style="height: 25px;">
    					<td align="right" style="padding-right: 0px">
    						&#160;
    					</td>
    					<td align="right" style="padding-right: 0px">
    						<h:outputText value="Tiền khám và CLS" styleClass="mytext"/>&#160;&#160;
    						<h:inputText readonly="true" value="#{(B3235_Thanhtoanphongcapcuu.hsttk.hsthtoankClsndm eq null) ? '0' : B3235_Thanhtoanphongcapcuu.hsttk.hsthtoankClsndm}"  id="__cls1" name="_cls1" style="width: 100px;" styleClass="myreadonlyso"><f:converter converterId="com.iesvn.yte.converter.LongDoubleConverter" /></h:inputText>&#160;
    						<h:inputText readonly="true" value="#{(B3235_Thanhtoanphongcapcuu.hsttk.hsthtoankCls eq null) ? '0' : B3235_Thanhtoanphongcapcuu.hsttk.hsthtoankCls}"  id="__cls2" name="_cls2" style="width: 100px;" styleClass="myreadonlyso"><f:converter converterId="com.iesvn.yte.converter.LongDoubleConverter" /></h:inputText>
    					 </td>
    					<td align="right" style="padding-right: 5px;">    						
    						<h:outputText  value="Lý do thất thu" styleClass="mytext"/>
    						
    					</td>
    					<td align="left" style="padding-right: 15px">
    						<h:inputText  value="#{B3235_Thanhtoanphongcapcuu.hsttk.hsthtoankLydott}" tabindex="5" id="__lydo" name="_lydo" style=" width : 219px;" styleClass="myinput"/>    						
    					
    					</td>
    				</tr>
    				<tr style="height: 25px;">
    					<td align="right" style="padding-right: 0px">
    						&#160;
    					</td>
    					<td align="right" style="padding-right: 0px">
    						<h:outputText value="Tổng chi" styleClass="mytext"/>&#160;&#160;
    						<h:inputText readonly="true" value="#{(B3235_Thanhtoanphongcapcuu.hsttk.hsthtoankNdm eq null) ? '0' : B3235_Thanhtoanphongcapcuu.hsttk.hsthtoankNdm}"  id="__tongchi1" name="_tongchi1" style="width: 100px;" styleClass="myreadonlyso"><f:converter converterId="com.iesvn.yte.converter.LongDoubleConverter" /></h:inputText>&#160;
    						<h:inputText readonly="true" value="#{(B3235_Thanhtoanphongcapcuu.hsttk.hsthtoankDm eq null) ? '0' : B3235_Thanhtoanphongcapcuu.hsttk.hsthtoankDm}"  id="__tongchi2" name="_tongchi2" style="width: 100px;" styleClass="myreadonlyso"><f:converter converterId="com.iesvn.yte.converter.LongDoubleConverter" /></h:inputText>
    					
    					</td>
    					<td align="right" style="padding-right: 5px;">    						
    						
    							<h:outputText value="Ngân sách" styleClass="mytext"/>
    						
    					</td>
    					<td align="left" style="padding-right: 15px">
    						<h:inputText readonly="true" value="#{B3235_Thanhtoanphongcapcuu.hsttk.hsthtoankNgansach}"  id="__ngansach" name="_ngansach" style="width: 100px;" styleClass="myreadonlyso"><f:converter converterId="com.iesvn.yte.converter.LongDoubleConverter" /></h:inputText>
    					
    					</td>
    				</tr>
    				<tr style="height: 25px;">
    					<td align="right" style="padding-right: 0px">
    						&#160;
    					</td>
    					<td align="right" style="padding-right: 0px">
    						<h:outputText value="Ký hiệu, Quyển, Biên lai" styleClass="mytext"/>&#160;&#160;
    						<h:inputText value="#{B3235_Thanhtoanphongcapcuu.hsttk.hsthtoankKyhieu}" maxlength="8" tabindex="6" id="__bienlai1" name="_bienlai1" style="width: 65px;" styleClass="myinput"/>&#160;
    						<h:inputText value="#{B3235_Thanhtoanphongcapcuu.hsttk.hsthtoankQuyen}" maxlength="8" tabindex="7" id="__bienlai2" name="_bienlai2" style=" width : 65px;" styleClass="myinput"/>&#160;
    						<h:inputText value="#{B3235_Thanhtoanphongcapcuu.hsttk.hsthtoankBienlai}" maxlength="8" tabindex="8" id="__bienlai3" name="_bienlai3" style="width: 65px;" styleClass="myinput"/>
    					
    					</td>
    					<td align="right" style="padding-right: 5px;">    						
    						<h:outputText value="Không thu" styleClass="mytext"/>
    						
    					</td>
    					<td align="left" style="padding-right: 15px">
    						<h:inputText readonly="true" value="#{B3235_Thanhtoanphongcapcuu.hsttk.hsthtoankKhongthu}"   id="__khongthu1" name="_khongthu1" style="width: 100px;" styleClass="myreadonlyso"><f:converter converterId="com.iesvn.yte.converter.LongDoubleConverter" /></h:inputText>&#160;
    						
    					</td>
    				</tr>
    				<tr style="height: 25px;">
    					<td align="right" style="padding-right: 0px">
    						
    					</td>
    					<td align="right" style="padding-right: 0px">
    						
    					</td>
    					<td align="right" style="padding-right: 5px;">    						
    						<h:outputText value="Nguồn khác trả" styleClass="mytext"/>
    						
    					</td>
    					<td align="left" style="padding-right: 15px">
    						<h:inputText value="#{B3235_Thanhtoanphongcapcuu.nguonkhactra}" id="__nguonkhactra" name="_nguonkhactra" style="width: 100px;" styleClass="myinputso" 
    						   onkeypress="iesvn_InputInKeys('0123456789');checkValidDot(this)" maxlength="10"
    						   onblur='numberFormatBlur(this);checkTienBNTra(this);'    						   
    						   ><f:converter converterId="com.iesvn.yte.converter.LongDoubleConverter" /></h:inputText>
    						
    					</td>
    				</tr>
    				<tr style="height: 25px;">
    					<td align="right" style="padding-right: 0px">
    						&#160;
    					</td>
    					<td align="right" style="padding-right: 0px">
    						&#160;
    					</td>
    					<td align="right" style="padding-right: 5px;">    						
    						<h:outputText value="Còn lại" styleClass="mytext"/>
    						
    					</td>
    					<td align="left" style="padding-right: 15px">
    						<h:inputText readonly="true" value="#{B3235_Thanhtoanphongcapcuu.conlai}"   id="__conlai" name="_conlai" style="width: 100px;" styleClass="myreadonlyso"><f:converter converterId="com.iesvn.yte.converter.LongDoubleConverter" /></h:inputText>&#160;
    						
    					</td>
    				</tr>
    				
    				
    					<tr style="height: 25px;">
    					
    					<td align="right" colspan="4" style="padding-left: 180px; padding-top: 10px;">
    						<div id="divGhiNhan" style="float:left;">
    								
    								<a4j:commandButton tabindex="9" 
    								 
    								onclick="if (! onSubmitTmp()) { return false; }"  id="__ghinhan" 
    								name="_ghinhan" action="#{B3235_Thanhtoanphongcapcuu.end()}" value="Ghi nhận" 
    								style="width: 70px; margin-right: 3px;" styleClass="mybton_b"  oncomplete="displayInphieu()" 
    								reRender="DT_DM_NHAN_VIEN_1,DM_DAN_TOC,DM_NGHE_NGHIEP,DM_TINH,DM_HUYEN,DM_XA,DM_DOI_TUONG,isUpdate,__message,__matiepdon, __giuongso, __gio, __ngay, __hoten, __gioitinh, __tuoi, __donViTuoiHid, __ngaysinh, __sinhtai, __madantoc, __manghenghiep, TINH_MA, HUYEN_MA, XA_MA, __sonha, __bhyt5, __madoituong, __thuoc1, __thuoc2, __vtth1, __vtth2, __cls1, __cls2, __phauthuat1, __phauthuat2, __phong1, __phong2, __tongchi1, __tongchi2, __khongthu2, __ungtra, __thatthu, __xetgiam, __dienmien, __lydo, __thanhtoan, __bienlai1, __bienlai2, __bienlai3,__ngansach,__khongthu1,__sodu,__sophieu,DT_DM_NHAN_VIEN_1,__conlai,__nguonkhactra,hid_nguonkhactra,hid_benhnhantra"></a4j:commandButton>
    							
    						</div>  
    						<div style="float: left;">
    								
    								<a4j:commandButton tabindex="10" id="__tieptucnhap" name="_tieptucnhap" 
    								 
    								action="#{B3235_Thanhtoanphongcapcuu.reset()}" value="Nhập mới" style="width: 80px; margin-right: 3px;" styleClass="mybton_b" 
    								oncomplete="onCompleteLoadTiepDon()" 
    								focus="__matiepdon"
    								reRender="DT_DM_NHAN_VIEN_1,__namsinhHid,DM_DAN_TOC,DM_NGHE_NGHIEP,DM_TINH,DM_HUYEN,DM_XA,DM_DOI_TUONG,isUpdate, __message, __matiepdon, __giuongso, __gio, __ngay, __hoten, __gioitinh, __tuoi, __donViTuoiHid, __ngaysinh, __sinhtai, __madantoc, __manghenghiep, TINH_MA, HUYEN_MA, XA_MA, __sonha, __bhyt5, __madoituong, __thuoc1, __thuoc2, __vtth1, __vtth2, __cls1, __cls2, __phauthuat1, __phauthuat2, __phong1, __phong2, __tongchi1, __tongchi2, __khongthu2, __ungtra, __thatthu, __xetgiam, __dienmien, __lydo, __thanhtoan, __bienlai1, __bienlai2, __bienlai3,__sodu,__sophieu,DT_DM_NHAN_VIEN_1,__conlai,__listClsKham,__listTPK,__nguonkhactra,hid_nguonkhactra,hid_benhnhantra,hid_conlai"/>
    							
    						</div> 
    						<div  id="divIn">
	    						
	    						<a4j:commandButton tabindex="11" id="__inphieu" name="_inphieu" 
	    							value="In phiếu" style="width: 65px;float:left; margin-left:3px" styleClass="mybton_b"
	                       			action="#{B3235_Thanhtoanphongcapcuu.inPhieu}"
	                       			reRender="__message"/>
	    					
    						</div>
    						<div  id="div_huyphieu">
	    						
	    						<a4j:commandButton tabindex="18" id="__huyphieu" name="_huyphieu" 
	    							value="Hủy phiếu" style="width: 65px;float:left; margin-left:3px" styleClass="mybton_b"
	                       			action="#{B3235_Thanhtoanphongcapcuu.huyPhieu}"
	                       			oncomplete="onCompleteLoadTiepDon();"
	                       			reRender="DT_DM_NHAN_VIEN_1,__namsinhHid,DM_DAN_TOC,DM_NGHE_NGHIEP,DM_TINH,DM_HUYEN,DM_XA,DM_DOI_TUONG,isUpdate, __message, __matiepdon, __giuongso, __gio, __ngay, __hoten, __gioitinh, __tuoi, __donViTuoiHid, __ngaysinh, __sinhtai, __madantoc, __manghenghiep, TINH_MA, HUYEN_MA, XA_MA, __sonha, __bhyt5, __madoituong, __thuoc1, __thuoc2, __vtth1, __vtth2, __cls1, __cls2, __phauthuat1, __phauthuat2, __phong1, __phong2, __tongchi1, __tongchi2, __khongthu2, __ungtra, __thatthu, __xetgiam, __dienmien, __lydo, __thanhtoan, __bienlai1, __bienlai2, __bienlai3,__sodu,__sophieu,DT_DM_NHAN_VIEN_1,__conlai,__nguonkhactra,hid_nguonkhactra,hid_benhnhantra,hid_conlai"/>
	    					
    						</div> 
    						<div  id="div_inphieuTT">
	    						
	    						<a4j:commandButton tabindex="19" id="__inphieuTT" name="_inphieuTT" 
	    							value="In phiếu thanh toán" style="width: 125px;float:left; margin-left:3px" styleClass="mybton_b"
	                       			action="#{B3235_Thanhtoanphongcapcuu.inPhieuThanhToan}"
	                       			reRender="__message"/>
	    					
    						</div>
    						
    						
    						
    					</td> 					
    				</tr>
    			</table>	
    		</td>
    	</tr>
    </table>
    <h:inputHidden id="hid_nguonkhactra" value="#{B3235_Thanhtoanphongcapcuu.nguonkhactra_hid}"/>
  <h:inputHidden id="hid_benhnhantra" value="#{B3235_Thanhtoanphongcapcuu.benhnhanTra_hid}"/>
  <h:inputHidden id="hid_conlai" value="#{B3235_Thanhtoanphongcapcuu.conlai_hid}"/>
   </h:form>
   </body>
   <iframe width="174" height="189" name="gToday:normal:agenda.js" id="gToday:normal:agenda.js" src="#{facesContext.externalContext.requestContextPath}/resources/calendar/ipopeng.htm" scrolling="no" frameborder="0" style="visibility:visible; z-index:999; position:absolute; top:-500px; left:-500px;"/>
   <script type="text/javascript" src="#{facesContext.externalContext.requestContextPath}/resources/gears/dieutri/vienphi/B3235_Thanhtoanphongcapcuu_gears.js"></script>
   
</ui:define> 
</ui:composition>


